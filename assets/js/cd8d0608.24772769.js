"use strict";(self.webpackChunkcompletium_landing=self.webpackChunkcompletium_landing||[]).push([[194],{9777:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return c},metadata:function(){return p},toc:function(){return d},default:function(){return h}});var i=n(7462),a=n(3366),r=(n(7294),n(3905)),o=n(9960),l=["components"],s={id:"verification2",title:"Tools",sidebar_label:"Tools",slug:"/verification/tools",hide_title:!1},c=void 0,p={unversionedId:"verification/verification2",id:"verification/verification2",title:"Tools",description:"The Tezos community provides a rich technical and human eco-system regarding formal verification:",source:"@site/docs/verification/verification2.md",sourceDirName:"verification",slug:"/verification/tools",permalink:"/docs/verification/tools",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/verification/verification2.md",tags:[],version:"current",frontMatter:{id:"verification2",title:"Tools",sidebar_label:"Tools",slug:"/verification/tools",hide_title:!1},sidebar:"verification",previous:{title:"Introduction",permalink:"/docs/verification"},next:{title:"Introduction",permalink:"/docs/verification/specification"}},d=[{value:"Archetype",id:"archetype",children:[{value:"Specification language",id:"specification-language",children:[],level:3},{value:"Whyml",id:"whyml",children:[],level:3}],level:2}],m={toc:d};function h(e){var t=e.components,n=(0,a.Z)(e,l);return(0,r.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The ",(0,r.kt)(o.Z,{to:"/docs/dapp-tools/tezos",mdxType:"Link"},"Tezos")," community provides a rich technical and human eco-system regarding formal verification:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Tools"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{href:"https://gitlab.com/nomadic-labs/mi-cho-coq/",target:"_blank"},"Michocoq")),(0,r.kt)("td",{parentName:"tr",align:"left"},"A specification of Michelson in ",(0,r.kt)(o.Z,{to:"https://coq.inria.fr/",mdxType:"Link"},"Coq")," to prove properties about smart contracts in Tezos.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{href:"https://archetype-lang.org/"},"Archetype")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Archetype provides a specification language for contract invariant and entry point postconditions. It generates the contract in the ",(0,r.kt)(o.Z,{to:"http://why3.lri.fr/",mdxType:"Link"},"Why3")," language for verification")))),(0,r.kt)(o.Z,{to:"https://coq.inria.fr/",mdxType:"Link"},"Coq")," is an interactive proof assistant. The user sends instructions to the proof engine to build up the proof step by step: apply a theorem to justify a proposition, rewrite a term by another and so on. It is possible to program macros for automation purpose. Proving a program in Coq requires the language semantic in Coq theory (provided by Michocoq for Michelson) used to prove the correctness of the program.",(0,r.kt)("p",null),(0,r.kt)(o.Z,{to:"http://why3.lri.fr/",mdxType:"Link"},"Why3")," is a plateform dedicated to program verification: it translates the program and specification into SMT problems (called proof obligation) for ",(0,r.kt)(o.Z,{to:"https://en.wikipedia.org/wiki/Satisfiability_modulo_theories#Solver_approaches",mdxType:"Link"},"SMT solvers")," to solve. When solvers succeed, the verification is automatic. When solvers fail, it is necessary to help them by providing intermediate properties about the program, that they can solve, and that they can use to solve the problem.",(0,r.kt)("h2",{id:"archetype"},"Archetype"),(0,r.kt)("p",null,"The Completium ",(0,r.kt)(o.Z,{to:"/docs/templates",mdxType:"Link"},"contract templates")," have been formally specified with Archetype."),(0,r.kt)("h3",{id:"specification-language"},"Specification language"),(0,r.kt)("p",null,"The Archetype specification language documentation is available ",(0,r.kt)(o.Z,{to:"https://docs.archetype-lang.org/archetype-language/contract-specification",mdxType:"Link"},"here"),"."),(0,r.kt)("p",null,"In a nutshell, what can you specify with it?"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"entrypoints' postconditions: a ",(0,r.kt)(o.Z,{to:"/docs/verification/postcondition",mdxType:"Link"},"postcondition")," is a property about what the execution of the entrypoint changes in the contract's storage."),(0,r.kt)("li",{parentName:"ul"},"entrypoints' fail conditions: a ",(0,r.kt)(o.Z,{to:"/docs/verification/fail",mdxType:"Link"},"fail condition")," is a property that holds true when the entrypoint is fails"),(0,r.kt)("li",{parentName:"ul"},"contract invariants: an ",(0,r.kt)(o.Z,{to:"/docs/verification/invariant",mdxType:"Link"},"invariant")," is a property about the contract's storage that is always true, regardless of the transactions history.")),(0,r.kt)("h3",{id:"whyml"},"Whyml"),(0,r.kt)("p",null,"Archetype generates the contract's code and specification in whyml, the ",(0,r.kt)("a",{href:"http://why3.lri.fr/",target:"_blank"},"Why3")," language."),(0,r.kt)("p",null,"The following ",(0,r.kt)(o.Z,{to:"/docs/cli",mdxType:"Link"},"Completium CLI")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"completium-cli generate whyml elementary.arl\n")),(0,r.kt)("p",null,"generates the whyml version of this elementary archetype contract:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-archetype",metastring:'title="elementary.arl"',title:'"elementary.arl"'},'archetype js\n\nvariable str : string = ""\n\nentry default(v : string) { str := v }\n\nspecification entry default(v :string) {\n    postcondition p {\n        str = v\n    }\n}\n')),(0,r.kt)("p",null,"The generated whyml program has two modules: ",(0,r.kt)("inlineCode",{parentName:"p"},"Elementary_storage")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Elementary"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ocaml",metastring:'{6,37-42} title="elementary.mlw"',"{6,37-42}":!0,title:'"elementary.mlw"'},'module Elementary_storage\n  use archetype.Lib\n  use list.List as L\n\n  type _storage = {\n    mutable str : arstring;\n    mutable _ops : L.list operation;\n    mutable _balance : tez;\n    _transferred : tez;\n    _caller : address;\n    _source : address;\n    _now : date;\n    _chainid : chain_id;\n    _selfaddress : address;\n  } by {\n    str = "";\n    _ops = L.Nil;\n    _balance = 0;\n    _transferred = 0;\n    _caller = "";\n    _source = "";\n    _now = 0;\n    _chainid = 0;\n    _selfaddress = "";\n    _entry = None;\n    _tr = L.Nil\n  }\n\n  val ref _s : _storage\n\nend\n\nmodule Elementary\n  use archetype.Lib\n  use Js_storage\n\n  let default (v : arstring) : unit\n  ensures {\n    [@expl:p]\n    _s.str = v\n  }\n  = _s.str <- v\n\nend\n')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"Elementary_storage")," defines the contract storage and all variables available to entrypoints (",(0,r.kt)("inlineCode",{parentName:"p"},"caller"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"transferred"),", ...). ",(0,r.kt)("inlineCode",{parentName:"p"},"Elementary")," defines entrypoints and their postconditions."),(0,r.kt)("p",null,"The postcondition ",(0,r.kt)("inlineCode",{parentName:"p"},"p")," is declared in whyml with the ",(0,r.kt)("inlineCode",{parentName:"p"},"ensures")," keyword."))}h.isMDXComponent=!0}}]);