(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{131:function(n,t,e){"use strict";e.r(t),e.d(t,"frontMatter",(function(){return U})),e.d(t,"metadata",(function(){return l})),e.d(t,"toc",(function(){return A})),e.d(t,"default",(function(){return G}));var D=e(3),a=(e(0),e(238)),r=e(239),I=e(252),i=e(253),P=e(284),o=e.n(P);const U={id:"template4",title:"DEX",sidebar_label:"DEX",slug:"/templates/dex"},l={unversionedId:"templates/template4",id:"templates/template4",isDocsHomePage:!1,title:"DEX",description:"Introduction",source:"@site/docs/templates/template4.md",slug:"/templates/dex",permalink:"/docs/templates/dex",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/templates/template4.md",version:"current",sidebar_label:"DEX",sidebar:"templates",previous:{title:"Zero-Coupon bond",permalink:"/docs/templates/zcb"},next:{title:"ICO",permalink:"/docs/templates/ico"}},A=[{value:"Introduction",id:"introduction",children:[]},{value:"API",id:"api",children:[{value:"Storage",id:"storage",children:[]},{value:"Entrypoints",id:"entrypoints",children:[]}]},{value:"Code",id:"code",children:[]}],s={toc:A};function G({components:n,...t}){return Object(a.b)("wrapper",Object(D.a)({},s,t,{components:n,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"introduction"},"Introduction"),Object(a.b)("p",null,"This Decentralized Exchange (DEX) presented here is based on the Uniswap-like exchange presented in this ",Object(a.b)("a",{href:"https://web.stanford.edu/~guillean/papers/uniswap_analysis.pdf",target:"_blank"},"paper"),". The principle is the one of automated market maker (AMM), that is that the exchange rate from token A to token B is computed automatically."),Object(a.b)("p",null,"To exchange ",Object(a.b)("em",{parentName:"p"},"qA")," tokens A against ",Object(a.b)("em",{parentName:"p"},"qB")," tokens B, the DEX establishes a pool of tokens A and a pool of tokens B, from which tokens are withdrawn or credited; if ",Object(a.b)("em",{parentName:"p"},"pA")," and ",Object(a.b)("em",{parentName:"p"},"pB")," are the numbers of tokens A and B in the pools, then the quantity ",Object(a.b)("em",{parentName:"p"},"qB")," of token B received in exchange of a quantity ",Object(a.b)("em",{parentName:"p"},"qA")," of token A is given by the following formula:"),Object(a.b)(o.a.Provider,null,Object(a.b)(o.a.Node,{formula:"qB = pB * \\frac{(1-f)*qA}{pA+(1-f)*qA}"})),Object(a.b)("p",null,"This principle is explained in more details in the ",Object(a.b)(r.a,{to:"/docs/dapp-dex",mdxType:"Link"},"DEX DApp")," example."),Object(a.b)("h2",{id:"api"},"API"),Object(a.b)("h3",{id:"storage"},"Storage"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",{parentName:"tr",align:null},"Name"),Object(a.b)("th",{parentName:"tr",align:null},"Type"),Object(a.b)("th",{parentName:"tr",align:null},"Description"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"admin")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"address")),Object(a.b)("td",{parentName:"tr",align:null},"Address that can register and unregister tokens in the DEX.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"token")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"collection")),Object(a.b)("td",{parentName:"tr",align:null},"Token data: ",Object(a.b)("ul",null,Object(a.b)("li",null,"token identifier (key)"),Object(a.b)("li",null,"FA 1.2 contract address"),Object(a.b)("li",null,"token name"),Object(a.b)("li",null,"XTZ value in pool"),Object(a.b)("li",null,"number of tokens in pool"),Object(a.b)("li",null,"number of liquidity tokens")))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"liquidity")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"collection")),Object(a.b)("td",{parentName:"tr",align:null},"Number of liquidity tokens per owner and token: ",Object(a.b)("ul",null,Object(a.b)("li",null,"token id (key)"),Object(a.b)("li",null,"owner (key)"),Object(a.b)("li",null,"number of liquidity tokens")))))),Object(a.b)("h3",{id:"entrypoints"},"Entrypoints"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",{parentName:"tr",align:null},"Name"),Object(a.b)("th",{parentName:"tr",align:null},"Parameters"),Object(a.b)("th",{parentName:"tr",align:null}))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"registertoken")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"i"),", ",Object(a.b)("inlineCode",{parentName:"td"},"a"),", ",Object(a.b)("inlineCode",{parentName:"td"},"n")),Object(a.b)("td",{parentName:"tr",align:null},"Admin adds token ",Object(a.b)("inlineCode",{parentName:"td"},"{\xa0i; a; n; 0; 0; 0 }")," to DEX.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"deletetoken")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"i")),Object(a.b)("td",{parentName:"tr",align:null},"Admin removes token ",Object(a.b)("inlineCode",{parentName:"td"},"i")," from DEX.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"exchange")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"tA"),", ",Object(a.b)("inlineCode",{parentName:"td"},"qA"),", ",Object(a.b)("inlineCode",{parentName:"td"},"tB"),", ",Object(a.b)("inlineCode",{parentName:"td"},"qB")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("em",{parentName:"td"},"Caller")," exchanges ",Object(a.b)("inlineCode",{parentName:"td"},"qA")," tokens ",Object(a.b)("inlineCode",{parentName:"td"},"tA")," for ",Object(a.b)("inlineCode",{parentName:"td"},"qB")," tokens ",Object(a.b)("inlineCode",{parentName:"td"},"tB"),".")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"addLiquidity")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"tA"),", ",Object(a.b)("inlineCode",{parentName:"td"},"qA")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("em",{parentName:"td"},"Caller")," provides ",Object(a.b)("inlineCode",{parentName:"td"},"qA")," tokens ",Object(a.b)("inlineCode",{parentName:"td"},"tA")," and the corresponding amount of XTZ is transferred.",Object(a.b)("p",null),"Liquidity tokens are minted and affected to  ",Object(a.b)("em",{parentName:"td"},"caller")," so that it reflects the proportion of ",Object(a.b)("em",{parentName:"td"},"transferred")," XTZ towards the XTZ pool.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"removeLiquidity")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("inlineCode",{parentName:"td"},"tA"),", ",Object(a.b)("inlineCode",{parentName:"td"},"qL")),Object(a.b)("td",{parentName:"tr",align:null},Object(a.b)("em",{parentName:"td"},"Caller")," redeems ",Object(a.b)("inlineCode",{parentName:"td"},"qL")," liquidity token for token ",Object(a.b)("inlineCode",{parentName:"td"},"tA"),"; 2 transactions are generated : ",Object(a.b)("ul",null,Object(a.b)("li",null,"transfer of XTZ in proportion of the token XTZ pool"),Object(a.b)("li",null,"transfer of ",Object(a.b)("inlineCode",{parentName:"td"},"tA")," tokens in proportion of the token pool")))))),Object(a.b)("h2",{id:"code"},"Code"),Object(a.b)(I.a,{defaultValue:"archetype",values:[{label:"Archetype",value:"archetype"},{label:"Michelson",value:"michelson"}],mdxType:"Tabs"},Object(a.b)(i.a,{value:"archetype",mdxType:"TabItem"},Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-archetype",metastring:'title="dex.arl"',title:'"dex.arl"'},'archetype dex(admin : address, initialminted : nat)\n\nconstant fee     : rational = 0.003\nconstant epsilon : nat      = 1\n\nasset token {\n  id        : string ;\n  addr      : address;\n  name      : string ;\n  xtzpool   : nat = 0;\n  tokpool   : nat = 0;\n  liqpool   : nat = 0;\n}\n\nasset liquidity identified by tokenid owner {\n  tokenid  : string ;\n  owner    : address;\n  liqt     : nat = 0;\n}\n\nentry registertoken (i : string, a : address, n : string) {\n  called by admin\n  failif { f1: i = "XTZ" }\n  effect { token.addupdate(i, { addr = a; name = n }); }\n}\n\nentry deletetoken (i : string) {\n  called by admin\n  effect { token.remove(i) }\n}\n\nfunction compute_qB(qA : nat, pA : nat, pB : nat) : rational {\n  var feeqA = (1 - fee) * qA;\n  return (pB * feeqA / (pA + feeqA))\n}\n\nentry exchange(tA : string, qA : nat, tB : string, qB : nat) {\n  require {\n    r0 otherwise "SRC_EQ_DST" : tA <> tB;\n  }\n  effect {\n    (* DEX receives *)\n    if tA = "XTZ" then begin\n      var pA = token[tB].xtzpool;\n      var pB = token[tB].tokpool;\n      var expected_qB = compute_qB(qA, pA, pB);\n      dorequire(abs(expected_qB - qB) <= epsilon, ("INVALID_B_AMOUNT", expected_qB));\n      var xtzin : nat = transferred;\n      dorequire(qA = xtzin, ("INVALID_A_AMOUNT", xtzin));\n      transfer 0tz to token[tB].addr\n        call %transfer<address * address * nat>((selfaddress, caller, qB));\n      token.update(tB, { xtzpool += xtzin; tokpool -= qB });\n    end else if tB = "XTZ" then begin\n      var pA = token[tA].tokpool;\n      var pB = token[tA].xtzpool;\n      var expected_qB = compute_qB(qA, pA, pB);\n      dorequire(abs(expected_qB - qB) <= epsilon, ("INVALID_B_AMOUNT", expected_qB));\n      transfer 0tz to token[tA].addr\n        call %transfer<address * address * nat>((caller, selfaddress, qA));\n      transfer (qB * 1utz) to caller;\n      token.update(tA, { xtzpool -= qB; tokpool += qA });\n    end else begin\n      var pA      = token[tA].tokpool;\n      var pXTZA   = token[tA].xtzpool;\n      var qXTZ    = abs(floor(compute_qB(qA, pA, pXTZA)));\n      var pXTZB   = token[tB].xtzpool;\n      var pB      = token[tB].tokpool;\n      var expected_qB = compute_qB(qXTZ, pXTZB, pB);\n      dorequire(abs(expected_qB - qB) <= epsilon, ("INVALID_B_AMOUNT", expected_qB));\n      transfer 0tz to token[tA].addr\n        call %transfer<address * address * nat>((caller, selfaddress, qA));\n      transfer 0tz to token[tB].addr\n        call %transfer<address * address * nat>((selfaddress, caller, qB));\n      token.update(tA, { xtzpool -= qXTZ; tokpool += qA });\n      token.update(tB, { xtzpool += qXTZ; tokpool -= qB });\n    end\n  }\n}\n\nentry addLiquidity(tA : string, qA : nat) {\n  (* transfer qA tokens tA to dex contract *)\n  transfer 0tz to token[tA].addr\n    call %transfer<address * address * nat>((caller, selfaddress, qA));\n  var xtzin : nat = transferred;\n  (* does qA tokens exchange for xtzin XTZ ? *)\n  var pA = token[tA].tokpool;\n  var pB = token[tA].xtzpool;\n  var expected_qB = compute_qB(qA, pA, pB);\n  dorequire(abs(expected_qB - xtzin) <= epsilon, ("INVALID_B_AMOUNT", expected_qB));\n  var mintedLiqT =\n    if token[tA].tokpool = 0\n    then initialminted\n    else abs(floor(token[tA].liqpool * xtzin / token[tA].xtzpool));\n  liquidity.addupdate((tA, caller), { liqt += mintedLiqT });\n  token.update(tA, { xtzpool += xtzin; tokpool += qA; liqpool += mintedLiqT })\n}\n\nentry removeLiquidity(tA : string, qL : nat) {\n  require {\n    r1 otherwise "NOT_ENOUGHT_LQT": qL <= liquidity[(tA, caller)].liqt\n  }\n  effect {\n    var liqratio = qL / token[tA].liqpool;\n    var xtzout = abs(floor(liqratio * token[tA].xtzpool));\n    transfer (xtzout * 1utz) to caller;\n    var qA = abs(floor(liqratio * token[tA].tokpool));\n    transfer 0tz to token[tA].addr\n      call %transfer<address * address * nat>((selfaddress, caller, qA));\n    liquidity.addupdate((tA, caller), { liqt -= qL });\n    token.update(tA, { xtzpool -= xtzout; tokpool -= qA; liqpool -= qL })\n  }\n}\n'))),Object(a.b)(i.a,{value:"michelson",mdxType:"TabItem"},Object(a.b)("pre",null,Object(a.b)("code",{parentName:"pre",className:"language-js"},'# (Pair admin (Pair initialminted (Pair {  } {  })))\n{\n  storage (pair (address %admin) (pair (nat %initialminted) (pair (map %token string (pair (address %addr) (pair (string %name) (pair (nat %xtzpool) (pair (nat %tokpool) (nat %liqpool)))))) (map %liquidity (pair string address) nat))));\n  parameter (or (pair %registertoken (string %i) (pair (address %a) (string %n))) (or (string %deletetoken) (or (pair %exchange (string %tA) (pair (nat %qA) (pair (string %tB) (nat %qB)))) (or (pair %addLiquidity (string %tA) (nat %qA)) (pair %removeLiquidity (string %tA) (nat %qL))))));\n  code { LAMBDA\n           (pair (pair (pair int nat) (pair int nat)) (or unit (or (or unit unit) (or unit unit))))\n           bool\n           { UNPAIR;\n             UNPAIR;\n             DIP { UNPAIR };\n             UNPAIR;\n             DUG 3;\n             MUL;\n             DIP { MUL };\n             SWAP;\n             COMPARE;\n             SWAP;\n             IF_LEFT\n               { DROP;\n                 EQ }\n               { IF_LEFT\n                   { IF_LEFT\n                       { DROP;\n                         LT }\n                       { DROP;\n                         LE } }\n                   { IF_LEFT\n                       { DROP;\n                         GT }\n                       { DROP;\n                         GE } } } };\n         LAMBDA\n           (pair (pair int nat) (pair nat (pair nat nat)))\n           (pair int nat)\n           { UNPAIR;\n             SWAP;\n             UNPAIR;\n             SWAP;\n             UNPAIR;\n             SWAP;\n             PUSH unit Unit;\n             PUSH nat 1;\n             DIG 4;\n             DUP;\n             DUG 5;\n             INT;\n             PAIR;\n             UNIT;\n             RIGHT unit;\n             PUSH nat 1000;\n             PUSH int 3;\n             PAIR;\n             PUSH nat 1;\n             PUSH nat 1;\n             INT;\n             PAIR;\n             PAIR;\n             PAIR;\n             UNPAIR;\n             UNPAIR;\n             DIP { UNPAIR; SWAP; DUP };\n             UNPAIR;\n             SWAP;\n             DUP;\n             DIG 3;\n             MUL;\n             DUG 4;\n             DIG 3;\n             MUL;\n             DIP { MUL };\n             DIG 3;\n             IF_LEFT\n               { DROP;\n                 ADD }\n               { DROP;\n                 SWAP;\n                 SUB };\n             PAIR;\n             PAIR;\n             UNPAIR;\n             DIP { UNPAIR };\n             UNPAIR;\n             DIP { SWAP };\n             MUL;\n             DIP { MUL };\n             PAIR;\n             UNIT;\n             LEFT unit;\n             DIG 1;\n             DUP;\n             DUG 2;\n             PUSH nat 1;\n             DIG 6;\n             DUP;\n             DUG 7;\n             INT;\n             PAIR;\n             PAIR;\n             PAIR;\n             UNPAIR;\n             UNPAIR;\n             DIP { UNPAIR; SWAP; DUP };\n             UNPAIR;\n             SWAP;\n             DUP;\n             DIG 3;\n             MUL;\n             DUG 4;\n             DIG 3;\n             MUL;\n             DIP { MUL };\n             DIG 3;\n             IF_LEFT\n               { DROP;\n                 ADD }\n               { DROP;\n                 SWAP;\n                 SUB };\n             PAIR;\n             DIG 1;\n             DUP;\n             DUG 2;\n             PUSH nat 1;\n             DIG 5;\n             DUP;\n             DUG 6;\n             INT;\n             PAIR;\n             PAIR;\n             UNPAIR;\n             DIP { UNPAIR };\n             UNPAIR;\n             DIP { SWAP };\n             MUL;\n             DIP { MUL };\n             PAIR;\n             PAIR;\n             UNPAIR;\n             DIP { UNPAIR };\n             UNPAIR;\n             DIG 3;\n             PUSH int 0;\n             DIG 4;\n             DUP;\n             DUG 5;\n             COMPARE;\n             GE;\n             IF\n               { INT }\n               { NEG };\n             MUL;\n             DIP { MUL; ABS };\n             PAIR;\n             DIP { DIG 1; DROP };\n             DUG 1;\n             DROP;\n             DUG 4;\n             DROP 4 };\n         NIL operation;\n         DIG 3;\n         UNPAIR;\n         DIP { UNPAIR; SWAP; UNPAIR; SWAP; UNPAIR; SWAP };\n         IF_LEFT\n           { UNPAIR;\n             SWAP;\n             UNPAIR;\n             SWAP;\n             DIG 6;\n             DUP;\n             DUG 7;\n             SENDER;\n             COMPARE;\n             EQ;\n             NOT;\n             IF\n               { PUSH string "InvalidCaller";\n                 FAILWITH }\n               {  };\n             PUSH string "XTZ";\n             DIG 3;\n             DUP;\n             DUG 4;\n             COMPARE;\n             EQ;\n             IF\n               { PUSH string "InvalidCondition: f1";\n                 FAILWITH }\n               {  };\n             DIG 4;\n             DUP;\n             DUG 5;\n             PUSH nat 0;\n             PUSH nat 0;\n             PAIR;\n             PUSH nat 0;\n             PAIR;\n             DIG 2;\n             DUP;\n             DUG 3;\n             PAIR;\n             DIG 3;\n             DUP;\n             DUG 4;\n             PAIR;\n             SOME;\n             DIG 4;\n             DUP;\n             DUG 5;\n             UPDATE;\n             DIP { DIG 4; DROP };\n             DUG 4;\n             DROP 3;\n             SWAP;\n             PAIR;\n             SWAP;\n             PAIR;\n             SWAP;\n             PAIR;\n             DIG 1;\n             PAIR }\n           { IF_LEFT\n               { DIG 4;\n                 DUP;\n                 DUG 5;\n                 SENDER;\n                 COMPARE;\n                 EQ;\n                 NOT;\n                 IF\n                   { PUSH string "InvalidCaller";\n                     FAILWITH }\n                   {  };\n                 DIG 2;\n                 DUP;\n                 DUG 3;\n                 NONE (pair address (pair string (pair nat (pair nat nat))));\n                 DIG 2;\n                 DUP;\n                 DUG 3;\n                 UPDATE;\n                 DIP { DIG 2; DROP };\n                 DUG 2;\n                 DROP;\n                 SWAP;\n                 PAIR;\n                 SWAP;\n                 PAIR;\n                 SWAP;\n                 PAIR;\n                 DIG 1;\n                 PAIR }\n               { IF_LEFT\n                   { UNPAIR;\n                     SWAP;\n                     UNPAIR;\n                     SWAP;\n                     UNPAIR;\n                     SWAP;\n                     DIG 1;\n                     DUP;\n                     DUG 2;\n                     DIG 4;\n                     DUP;\n                     DUG 5;\n                     COMPARE;\n                     NEQ;\n                     NOT;\n                     IF\n                       { PUSH string "SRC_EQ_DST";\n                         FAILWITH }\n                       {  };\n                     PUSH string "XTZ";\n                     DIG 4;\n                     DUP;\n                     DUG 5;\n                     COMPARE;\n                     EQ;\n                     IF\n                       { DIG 5;\n                         DUP;\n                         DUG 6;\n                         DIG 2;\n                         DUP;\n                         DUG 3;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CAR;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         DIG 11;\n                         DUP;\n                         DUG 12;\n                         DIG 1;\n                         DUP;\n                         DUG 2;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         PAIR;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         PAIR;\n                         PUSH nat 1000;\n                         PUSH int 3;\n                         PAIR;\n                         PAIR;\n                         EXEC;\n                         DIG 13;\n                         DUP;\n                         DUG 14;\n                         UNIT;\n                         RIGHT unit;\n                         LEFT (or unit unit);\n                         RIGHT unit;\n                         PUSH nat 1;\n                         PUSH nat 1;\n                         INT;\n                         PAIR;\n                         UNIT;\n                         RIGHT unit;\n                         PUSH nat 1;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         INT;\n                         PAIR;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         PAIR;\n                         PAIR;\n                         UNPAIR;\n                         UNPAIR;\n                         DIP { UNPAIR; SWAP; DUP };\n                         UNPAIR;\n                         SWAP;\n                         DUP;\n                         DIG 3;\n                         MUL;\n                         DUG 4;\n                         DIG 3;\n                         MUL;\n                         DIP { MUL };\n                         DIG 3;\n                         IF_LEFT\n                           { DROP;\n                             ADD }\n                           { DROP;\n                             SWAP;\n                             SUB };\n                         PAIR;\n                         UNPAIR;\n                         ABS;\n                         INT;\n                         PAIR;\n                         PAIR;\n                         PAIR;\n                         EXEC;\n                         NOT;\n                         IF\n                           { DUP;\n                             PUSH string "INVALID_B_AMOUNT";\n                             PAIR;\n                             FAILWITH }\n                           {  };\n                         PUSH mutez 1;\n                         AMOUNT;\n                         EDIV;\n                         IF_NONE\n                           { PUSH string "DivByZero";\n                             FAILWITH }\n                           { DUP;\n                             CAR;\n                             SWAP;\n                             DROP };\n                         DUP;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         COMPARE;\n                         EQ;\n                         NOT;\n                         IF\n                           { DUP;\n                             PUSH string "INVALID_A_AMOUNT";\n                             PAIR;\n                             FAILWITH }\n                           {  };\n                         DIG 12;\n                         DUP;\n                         DUG 13;\n                         DIG 10;\n                         DUP;\n                         DUG 11;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CAR;\n                         CONTRACT %transfer (pair address (pair address nat));\n                         IF_NONE\n                           { PUSH string "BadContract";\n                             FAILWITH }\n                           {  };\n                         PUSH mutez 0;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         SENDER;\n                         PAIR;\n                         SELF;\n                         ADDRESS;\n                         PAIR;\n                         TRANSFER_TOKENS;\n                         CONS;\n                         DIP { DIG 12; DROP };\n                         DUG 12;\n                         DIG 9;\n                         DUP;\n                         DUG 10;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         DIG 10;\n                         DUP;\n                         DUG 11;\n                         DIG 11;\n                         DUP;\n                         DUG 12;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         UNPAIR;\n                         SWAP;\n                         UNPAIR;\n                         SWAP;\n                         UNPAIR;\n                         DROP;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         CDR;\n                         CDR;\n                         CAR;\n                         ADD;\n                         SWAP;\n                         UNPAIR;\n                         DROP;\n                         PUSH int 0;\n                         DIG 11;\n                         DUP;\n                         DUG 12;\n                         INT;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         SUB;\n                         COMPARE;\n                         GE;\n                         IF\n                           { DIG 10;\n                             DUP;\n                             DUG 11;\n                             INT;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             SUB;\n                             ABS }\n                           { PUSH string "AssignNat";\n                             FAILWITH };\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SOME;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         UPDATE;\n                         DIP { DIG 10; DROP };\n                         DUG 10;\n                         DROP 5 }\n                       { PUSH string "XTZ";\n                         DIG 2;\n                         DUP;\n                         DUG 3;\n                         COMPARE;\n                         EQ;\n                         IF\n                           { DIG 5;\n                             DUP;\n                             DUG 6;\n                             DIG 4;\n                             DUP;\n                             DUG 5;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CAR;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             DIG 1;\n                             DUP;\n                             DUG 2;\n                             DIG 3;\n                             DUP;\n                             DUG 4;\n                             PAIR;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             PAIR;\n                             PUSH nat 1000;\n                             PUSH int 3;\n                             PAIR;\n                             PAIR;\n                             EXEC;\n                             DIG 13;\n                             DUP;\n                             DUG 14;\n                             UNIT;\n                             RIGHT unit;\n                             LEFT (or unit unit);\n                             RIGHT unit;\n                             PUSH nat 1;\n                             PUSH nat 1;\n                             INT;\n                             PAIR;\n                             UNIT;\n                             RIGHT unit;\n                             PUSH nat 1;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             INT;\n                             PAIR;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             PAIR;\n                             PAIR;\n                             UNPAIR;\n                             UNPAIR;\n                             DIP { UNPAIR; SWAP; DUP };\n                             UNPAIR;\n                             SWAP;\n                             DUP;\n                             DIG 3;\n                             MUL;\n                             DUG 4;\n                             DIG 3;\n                             MUL;\n                             DIP { MUL };\n                             DIG 3;\n                             IF_LEFT\n                               { DROP;\n                                 ADD }\n                               { DROP;\n                                 SWAP;\n                                 SUB };\n                             PAIR;\n                             UNPAIR;\n                             ABS;\n                             INT;\n                             PAIR;\n                             PAIR;\n                             PAIR;\n                             EXEC;\n                             NOT;\n                             IF\n                               { DUP;\n                                 PUSH string "INVALID_B_AMOUNT";\n                                 PAIR;\n                                 FAILWITH }\n                               {  };\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CAR;\n                             CONTRACT %transfer (pair address (pair address nat));\n                             IF_NONE\n                               { PUSH string "BadContract";\n                                 FAILWITH }\n                               {  };\n                             PUSH mutez 0;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             SELF;\n                             ADDRESS;\n                             PAIR;\n                             SENDER;\n                             PAIR;\n                             TRANSFER_TOKENS;\n                             CONS;\n                             DIP { DIG 11; DROP };\n                             DUG 11;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             SENDER;\n                             CONTRACT unit;\n                             IF_NONE\n                               { PUSH string "BadContract";\n                                 FAILWITH }\n                               {  };\n                             PUSH mutez 1;\n                             PUSH nat 1;\n                             DIG 7;\n                             DUP;\n                             DUG 8;\n                             INT;\n                             PAIR;\n                             PAIR;\n                             UNPAIR;\n                             UNPAIR;\n                             ABS;\n                             DIG 2;\n                             MUL;\n                             EDIV;\n                             IF_NONE\n                               { PUSH string "DivByZero";\n                                 FAILWITH }\n                               {  };\n                             CAR;\n                             UNIT;\n                             TRANSFER_TOKENS;\n                             CONS;\n                             DIP { DIG 11; DROP };\n                             DUG 11;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             DIG 7;\n                             DUP;\n                             DUG 8;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             DIG 10;\n                             DUP;\n                             DUG 11;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             UNPAIR;\n                             SWAP;\n                             UNPAIR;\n                             SWAP;\n                             UNPAIR;\n                             DROP;\n                             PUSH int 0;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             INT;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CAR;\n                             SUB;\n                             COMPARE;\n                             GE;\n                             IF\n                               { DIG 8;\n                                 DUP;\n                                 DUG 9;\n                                 INT;\n                                 DIG 5;\n                                 DUP;\n                                 DUG 6;\n                                 CDR;\n                                 CDR;\n                                 CAR;\n                                 SUB;\n                                 ABS }\n                               { PUSH string "AssignNat";\n                                 FAILWITH };\n                             SWAP;\n                             UNPAIR;\n                             DROP;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             ADD;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SOME;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             UPDATE;\n                             DIP { DIG 9; DROP };\n                             DUG 9;\n                             DROP 4 }\n                           { DIG 5;\n                             DUP;\n                             DUG 6;\n                             DIG 4;\n                             DUP;\n                             DUG 5;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CAR;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             DIG 1;\n                             DUP;\n                             DUG 2;\n                             DIG 3;\n                             DUP;\n                             DUG 4;\n                             PAIR;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             PAIR;\n                             PUSH nat 1000;\n                             PUSH int 3;\n                             PAIR;\n                             PAIR;\n                             EXEC;\n                             UNPAIR;\n                             EDIV;\n                             IF_NONE\n                               { PUSH string "DivByZero";\n                                 FAILWITH }\n                               { CAR };\n                             ABS;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CAR;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             DIG 14;\n                             DUP;\n                             DUG 15;\n                             DIG 1;\n                             DUP;\n                             DUG 2;\n                             DIG 3;\n                             DUP;\n                             DUG 4;\n                             PAIR;\n                             DIG 4;\n                             DUP;\n                             DUG 5;\n                             PAIR;\n                             PUSH nat 1000;\n                             PUSH int 3;\n                             PAIR;\n                             PAIR;\n                             EXEC;\n                             DIG 16;\n                             DUP;\n                             DUG 17;\n                             UNIT;\n                             RIGHT unit;\n                             LEFT (or unit unit);\n                             RIGHT unit;\n                             PUSH nat 1;\n                             PUSH nat 1;\n                             INT;\n                             PAIR;\n                             UNIT;\n                             RIGHT unit;\n                             PUSH nat 1;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             INT;\n                             PAIR;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             PAIR;\n                             PAIR;\n                             UNPAIR;\n                             UNPAIR;\n                             DIP { UNPAIR; SWAP; DUP };\n                             UNPAIR;\n                             SWAP;\n                             DUP;\n                             DIG 3;\n                             MUL;\n                             DUG 4;\n                             DIG 3;\n                             MUL;\n                             DIP { MUL };\n                             DIG 3;\n                             IF_LEFT\n                               { DROP;\n                                 ADD }\n                               { DROP;\n                                 SWAP;\n                                 SUB };\n                             PAIR;\n                             UNPAIR;\n                             ABS;\n                             INT;\n                             PAIR;\n                             PAIR;\n                             PAIR;\n                             EXEC;\n                             NOT;\n                             IF\n                               { DUP;\n                                 PUSH string "INVALID_B_AMOUNT";\n                                 PAIR;\n                                 FAILWITH }\n                               {  };\n                             DIG 14;\n                             DUP;\n                             DUG 15;\n                             DIG 12;\n                             DUP;\n                             DUG 13;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CAR;\n                             CONTRACT %transfer (pair address (pair address nat));\n                             IF_NONE\n                               { PUSH string "BadContract";\n                                 FAILWITH }\n                               {  };\n                             PUSH mutez 0;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             SELF;\n                             ADDRESS;\n                             PAIR;\n                             SENDER;\n                             PAIR;\n                             TRANSFER_TOKENS;\n                             CONS;\n                             DIP { DIG 14; DROP };\n                             DUG 14;\n                             DIG 14;\n                             DUP;\n                             DUG 15;\n                             DIG 12;\n                             DUP;\n                             DUG 13;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CAR;\n                             CONTRACT %transfer (pair address (pair address nat));\n                             IF_NONE\n                               { PUSH string "BadContract";\n                                 FAILWITH }\n                               {  };\n                             PUSH mutez 0;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             SENDER;\n                             PAIR;\n                             SELF;\n                             ADDRESS;\n                             PAIR;\n                             TRANSFER_TOKENS;\n                             CONS;\n                             DIP { DIG 14; DROP };\n                             DUG 14;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             DIG 10;\n                             DUP;\n                             DUG 11;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             DIG 12;\n                             DUP;\n                             DUG 13;\n                             DIG 13;\n                             DUP;\n                             DUG 14;\n                             DIG 12;\n                             DUP;\n                             DUG 13;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             UNPAIR;\n                             SWAP;\n                             UNPAIR;\n                             SWAP;\n                             UNPAIR;\n                             DROP;\n                             PUSH int 0;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             INT;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CAR;\n                             SUB;\n                             COMPARE;\n                             GE;\n                             IF\n                               { DIG 8;\n                                 DUP;\n                                 DUG 9;\n                                 INT;\n                                 DIG 5;\n                                 DUP;\n                                 DUG 6;\n                                 CDR;\n                                 CDR;\n                                 CAR;\n                                 SUB;\n                                 ABS }\n                               { PUSH string "AssignNat";\n                                 FAILWITH };\n                             SWAP;\n                             UNPAIR;\n                             DROP;\n                             DIG 14;\n                             DUP;\n                             DUG 15;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             ADD;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SOME;\n                             DIG 12;\n                             DUP;\n                             DUG 13;\n                             UPDATE;\n                             DIP { DIG 12; DROP };\n                             DUG 12;\n                             DROP;\n                             DIG 11;\n                             DUP;\n                             DUG 12;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             DIG 12;\n                             DUP;\n                             DUG 13;\n                             DIG 13;\n                             DUP;\n                             DUG 14;\n                             DIG 10;\n                             DUP;\n                             DUG 11;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             UNPAIR;\n                             SWAP;\n                             UNPAIR;\n                             SWAP;\n                             UNPAIR;\n                             DROP;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             CDR;\n                             CDR;\n                             CAR;\n                             ADD;\n                             SWAP;\n                             UNPAIR;\n                             DROP;\n                             PUSH int 0;\n                             DIG 13;\n                             DUP;\n                             DUG 14;\n                             INT;\n                             DIG 7;\n                             DUP;\n                             DUG 8;\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             SUB;\n                             COMPARE;\n                             GE;\n                             IF\n                               { DIG 12;\n                                 DUP;\n                                 DUG 13;\n                                 INT;\n                                 DIG 6;\n                                 DUP;\n                                 DUG 7;\n                                 CDR;\n                                 CDR;\n                                 CDR;\n                                 CAR;\n                                 SUB;\n                                 ABS }\n                               { PUSH string "AssignNat";\n                                 FAILWITH };\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SWAP;\n                             PAIR;\n                             SOME;\n                             DIG 10;\n                             DUP;\n                             DUG 11;\n                             UPDATE;\n                             DIP { DIG 12; DROP };\n                             DUG 12;\n                             DROP 7 } };\n                     DROP 4;\n                     SWAP;\n                     PAIR;\n                     SWAP;\n                     PAIR;\n                     SWAP;\n                     PAIR;\n                     DIG 1;\n                     PAIR }\n                   { IF_LEFT\n                       { UNPAIR;\n                         SWAP;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CAR;\n                         CONTRACT %transfer (pair address (pair address nat));\n                         IF_NONE\n                           { PUSH string "BadContract";\n                             FAILWITH }\n                           {  };\n                         PUSH mutez 0;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         SELF;\n                         ADDRESS;\n                         PAIR;\n                         SENDER;\n                         PAIR;\n                         TRANSFER_TOKENS;\n                         CONS;\n                         DIP { DIG 6; DROP };\n                         DUG 6;\n                         PUSH mutez 1;\n                         AMOUNT;\n                         EDIV;\n                         IF_NONE\n                           { PUSH string "DivByZero";\n                             FAILWITH }\n                           { DUP;\n                             CAR;\n                             SWAP;\n                             DROP };\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CAR;\n                         DIG 10;\n                         DUP;\n                         DUG 11;\n                         DIG 1;\n                         DUP;\n                         DUG 2;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         PAIR;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         PAIR;\n                         PUSH nat 1000;\n                         PUSH int 3;\n                         PAIR;\n                         PAIR;\n                         EXEC;\n                         DIG 12;\n                         DUP;\n                         DUG 13;\n                         UNIT;\n                         RIGHT unit;\n                         LEFT (or unit unit);\n                         RIGHT unit;\n                         PUSH nat 1;\n                         PUSH nat 1;\n                         INT;\n                         PAIR;\n                         UNIT;\n                         RIGHT unit;\n                         PUSH nat 1;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         INT;\n                         PAIR;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         PAIR;\n                         PAIR;\n                         UNPAIR;\n                         UNPAIR;\n                         DIP { UNPAIR; SWAP; DUP };\n                         UNPAIR;\n                         SWAP;\n                         DUP;\n                         DIG 3;\n                         MUL;\n                         DUG 4;\n                         DIG 3;\n                         MUL;\n                         DIP { MUL };\n                         DIG 3;\n                         IF_LEFT\n                           { DROP;\n                             ADD }\n                           { DROP;\n                             SWAP;\n                             SUB };\n                         PAIR;\n                         UNPAIR;\n                         ABS;\n                         INT;\n                         PAIR;\n                         PAIR;\n                         PAIR;\n                         EXEC;\n                         NOT;\n                         IF\n                           { DUP;\n                             PUSH string "INVALID_B_AMOUNT";\n                             PAIR;\n                             FAILWITH }\n                           {  };\n                         PUSH nat 0;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         COMPARE;\n                         EQ;\n                         IF\n                           { DIG 8;\n                             DUP;\n                             DUG 9 }\n                           { PUSH nat 1;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             DIG 7;\n                             DUP;\n                             DUG 8;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CAR;\n                             INT;\n                             PAIR;\n                             PUSH nat 1;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             DIG 10;\n                             DUP;\n                             DUG 11;\n                             DIG 9;\n                             DUP;\n                             DUG 10;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             CDR;\n                             CDR;\n                             CDR;\n                             CDR;\n                             MUL;\n                             INT;\n                             PAIR;\n                             PAIR;\n                             UNPAIR;\n                             DIP { UNPAIR };\n                             UNPAIR;\n                             DIG 3;\n                             PUSH int 0;\n                             DIG 4;\n                             DUP;\n                             DUG 5;\n                             COMPARE;\n                             GE;\n                             IF\n                               { INT }\n                               { NEG };\n                             MUL;\n                             DIP { MUL; ABS };\n                             PAIR;\n                             UNPAIR;\n                             EDIV;\n                             IF_NONE\n                               { PUSH string "DivByZero";\n                                 FAILWITH }\n                               { CAR };\n                             ABS };\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         SENDER;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         PAIR;\n                         MEM;\n                         IF\n                           { DIG 7;\n                             DUP;\n                             DUG 8;\n                             SENDER;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             PAIR;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             DIG 2;\n                             DUP;\n                             DUG 3;\n                             DIG 2;\n                             DUP;\n                             DUG 3;\n                             ADD;\n                             SOME;\n                             SENDER;\n                             DIG 10;\n                             DUP;\n                             DUG 11;\n                             PAIR;\n                             UPDATE;\n                             DIP { DIG 8; DROP };\n                             DUG 8;\n                             DROP }\n                           { DIG 7;\n                             DUP;\n                             DUG 8;\n                             SENDER;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             PAIR;\n                             MEM;\n                             IF\n                               { PUSH string "KeyAlreadyExists";\n                                 FAILWITH }\n                               { DIG 7;\n                                 DUP;\n                                 DUG 8;\n                                 DIG 1;\n                                 DUP;\n                                 DUG 2;\n                                 PUSH nat 0;\n                                 ADD;\n                                 SOME;\n                                 SENDER;\n                                 DIG 9;\n                                 DUP;\n                                 DUG 10;\n                                 PAIR;\n                                 UPDATE;\n                                 DIP { DIG 7; DROP };\n                                 DUG 7 } };\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         DIG 9;\n                         DUP;\n                         DUG 10;\n                         DIG 10;\n                         DUP;\n                         DUG 11;\n                         DIG 9;\n                         DUP;\n                         DUG 10;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         UNPAIR;\n                         SWAP;\n                         UNPAIR;\n                         SWAP;\n                         UNPAIR;\n                         DROP;\n                         DIG 9;\n                         DUP;\n                         DUG 10;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         CDR;\n                         CDR;\n                         CAR;\n                         ADD;\n                         SWAP;\n                         UNPAIR;\n                         DROP;\n                         DIG 11;\n                         DUP;\n                         DUG 12;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         ADD;\n                         SWAP;\n                         DROP;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         CDR;\n                         CDR;\n                         CDR;\n                         CDR;\n                         ADD;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SOME;\n                         DIG 9;\n                         DUP;\n                         DUG 10;\n                         UPDATE;\n                         DIP { DIG 9; DROP };\n                         DUG 9;\n                         DROP 8;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         DIG 1;\n                         PAIR }\n                       { UNPAIR;\n                         SWAP;\n                         DIG 2;\n                         DUP;\n                         DUG 3;\n                         SENDER;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         PAIR;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         DIG 1;\n                         DUP;\n                         DUG 2;\n                         COMPARE;\n                         LE;\n                         NOT;\n                         IF\n                           { PUSH string "NOT_ENOUGHT_LQT";\n                             FAILWITH }\n                           {  };\n                         PUSH nat 1;\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CDR;\n                         CDR;\n                         INT;\n                         PAIR;\n                         PUSH nat 1;\n                         DIG 2;\n                         DUP;\n                         DUG 3;\n                         INT;\n                         PAIR;\n                         PAIR;\n                         UNPAIR;\n                         DIP { UNPAIR };\n                         UNPAIR;\n                         DIG 3;\n                         PUSH int 0;\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         COMPARE;\n                         GE;\n                         IF\n                           { INT }\n                           { NEG };\n                         MUL;\n                         DIP { MUL; ABS };\n                         PAIR;\n                         PUSH nat 1;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CAR;\n                         INT;\n                         PAIR;\n                         DIG 1;\n                         DUP;\n                         DUG 2;\n                         PAIR;\n                         UNPAIR;\n                         DIP { UNPAIR };\n                         UNPAIR;\n                         DIP { SWAP };\n                         MUL;\n                         DIP { MUL };\n                         PAIR;\n                         UNPAIR;\n                         EDIV;\n                         IF_NONE\n                           { PUSH string "DivByZero";\n                             FAILWITH }\n                           { CAR };\n                         ABS;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         SENDER;\n                         CONTRACT unit;\n                         IF_NONE\n                           { PUSH string "BadContract";\n                             FAILWITH }\n                           {  };\n                         PUSH mutez 1;\n                         PUSH nat 1;\n                         DIG 4;\n                         DUP;\n                         DUG 5;\n                         INT;\n                         PAIR;\n                         PAIR;\n                         UNPAIR;\n                         UNPAIR;\n                         ABS;\n                         DIG 2;\n                         MUL;\n                         EDIV;\n                         IF_NONE\n                           { PUSH string "DivByZero";\n                             FAILWITH }\n                           {  };\n                         CAR;\n                         UNIT;\n                         TRANSFER_TOKENS;\n                         CONS;\n                         DIP { DIG 8; DROP };\n                         DUG 8;\n                         PUSH nat 1;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         INT;\n                         PAIR;\n                         DIG 2;\n                         DUP;\n                         DUG 3;\n                         PAIR;\n                         UNPAIR;\n                         DIP { UNPAIR };\n                         UNPAIR;\n                         DIP { SWAP };\n                         MUL;\n                         DIP { MUL };\n                         PAIR;\n                         UNPAIR;\n                         EDIV;\n                         IF_NONE\n                           { PUSH string "DivByZero";\n                             FAILWITH }\n                           { CAR };\n                         ABS;\n                         DIG 9;\n                         DUP;\n                         DUG 10;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         CAR;\n                         CONTRACT %transfer (pair address (pair address nat));\n                         IF_NONE\n                           { PUSH string "BadContract";\n                             FAILWITH }\n                           {  };\n                         PUSH mutez 0;\n                         DIG 3;\n                         DUP;\n                         DUG 4;\n                         SENDER;\n                         PAIR;\n                         SELF;\n                         ADDRESS;\n                         PAIR;\n                         TRANSFER_TOKENS;\n                         CONS;\n                         DIP { DIG 9; DROP };\n                         DUG 9;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         SENDER;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         PAIR;\n                         MEM;\n                         IF\n                           { DIG 5;\n                             DUP;\n                             DUG 6;\n                             SENDER;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             PAIR;\n                             GET;\n                             IF_NONE\n                               { PUSH string "GetNoneValue";\n                                 FAILWITH }\n                               {  };\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             PUSH int 0;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             INT;\n                             DIG 3;\n                             DUP;\n                             DUG 4;\n                             SUB;\n                             COMPARE;\n                             GE;\n                             IF\n                               { DIG 5;\n                                 DUP;\n                                 DUG 6;\n                                 INT;\n                                 DIG 2;\n                                 DUP;\n                                 DUG 3;\n                                 SUB;\n                                 ABS }\n                               { PUSH string "AssignNat";\n                                 FAILWITH };\n                             SOME;\n                             SENDER;\n                             DIG 8;\n                             DUP;\n                             DUG 9;\n                             PAIR;\n                             UPDATE;\n                             DIP { DIG 6; DROP };\n                             DUG 6;\n                             DROP }\n                           { DIG 5;\n                             DUP;\n                             DUG 6;\n                             SENDER;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             PAIR;\n                             MEM;\n                             IF\n                               { PUSH string "KeyAlreadyExists";\n                                 FAILWITH }\n                               { DIG 5;\n                                 DUP;\n                                 DUG 6;\n                                 PUSH int 0;\n                                 DIG 5;\n                                 DUP;\n                                 DUG 6;\n                                 INT;\n                                 PUSH nat 0;\n                                 SUB;\n                                 COMPARE;\n                                 GE;\n                                 IF\n                                   { DIG 4;\n                                     DUP;\n                                     DUG 5;\n                                     INT;\n                                     PUSH nat 0;\n                                     SUB;\n                                     ABS }\n                                   { PUSH string "AssignNat";\n                                     FAILWITH };\n                                 SOME;\n                                 SENDER;\n                                 DIG 7;\n                                 DUP;\n                                 DUG 8;\n                                 PAIR;\n                                 UPDATE;\n                                 DIP { DIG 5; DROP };\n                                 DUG 5 } };\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         DIG 5;\n                         DUP;\n                         DUG 6;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         DIG 8;\n                         DUP;\n                         DUG 9;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         GET;\n                         IF_NONE\n                           { PUSH string "GetNoneValue";\n                             FAILWITH }\n                           {  };\n                         UNPAIR;\n                         SWAP;\n                         UNPAIR;\n                         SWAP;\n                         UNPAIR;\n                         DROP;\n                         PUSH int 0;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         INT;\n                         DIG 6;\n                         DUP;\n                         DUG 7;\n                         CDR;\n                         CDR;\n                         CAR;\n                         SUB;\n                         COMPARE;\n                         GE;\n                         IF\n                           { DIG 6;\n                             DUP;\n                             DUG 7;\n                             INT;\n                             DIG 5;\n                             DUP;\n                             DUG 6;\n                             CDR;\n                             CDR;\n                             CAR;\n                             SUB;\n                             ABS }\n                           { PUSH string "AssignNat";\n                             FAILWITH };\n                         SWAP;\n                         UNPAIR;\n                         DROP;\n                         PUSH int 0;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         INT;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         CDR;\n                         CDR;\n                         CDR;\n                         CAR;\n                         SUB;\n                         COMPARE;\n                         GE;\n                         IF\n                           { DIG 6;\n                             DUP;\n                             DUG 7;\n                             INT;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CDR;\n                             CAR;\n                             SUB;\n                             ABS }\n                           { PUSH string "AssignNat";\n                             FAILWITH };\n                         SWAP;\n                         DROP;\n                         PUSH int 0;\n                         DIG 10;\n                         DUP;\n                         DUG 11;\n                         INT;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         CDR;\n                         CDR;\n                         CDR;\n                         CDR;\n                         SUB;\n                         COMPARE;\n                         GE;\n                         IF\n                           { DIG 9;\n                             DUP;\n                             DUG 10;\n                             INT;\n                             DIG 6;\n                             DUP;\n                             DUG 7;\n                             CDR;\n                             CDR;\n                             CDR;\n                             CDR;\n                             SUB;\n                             ABS }\n                           { PUSH string "AssignNat";\n                             FAILWITH };\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SOME;\n                         DIG 7;\n                         DUP;\n                         DUG 8;\n                         UPDATE;\n                         DIP { DIG 7; DROP };\n                         DUG 7;\n                         DROP 6;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         SWAP;\n                         PAIR;\n                         DIG 1;\n                         PAIR } } } };\n         DIP { DROP 2 } };\n}\n')))))}G.isMDXComponent=!0},244:function(n,t,e){"use strict";function D(n){var t,e,a="";if("string"==typeof n||"number"==typeof n)a+=n;else if("object"==typeof n)if(Array.isArray(n))for(t=0;t<n.length;t++)n[t]&&(e=D(n[t]))&&(a&&(a+=" "),a+=e);else for(t in n)n[t]&&(a&&(a+=" "),a+=t);return a}t.a=function(){for(var n,t,e=0,a="";e<arguments.length;)(n=arguments[e++])&&(t=D(n))&&(a&&(a+=" "),a+=t);return a}},250:function(n,t,e){"use strict";var D=e(0),a=e(251);t.a=function(){const n=Object(D.useContext)(a.a);if(null==n)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return n}},251:function(n,t,e){"use strict";var D=e(0);const a=Object(D.createContext)(void 0);t.a=a},252:function(n,t,e){"use strict";var D=e(0),a=e.n(D),r=e(250),I=e(244),i=e(57),P=e.n(i);const o=37,U=39;t.a=function(n){const{lazy:t,block:e,defaultValue:i,values:l,groupId:A,className:s}=n,{tabGroupChoices:G,setTabGroupChoices:R}=Object(r.a)(),[d,c]=Object(D.useState)(i),u=D.Children.toArray(n.children),N=[];if(null!=A){const n=G[A];null!=n&&n!==d&&l.some((t=>t.value===n))&&c(n)}const p=n=>{const t=n.target,e=N.indexOf(t),D=u[e].props.value;c(D),null!=A&&(R(A,D),setTimeout((()=>{(function(n){const{top:t,left:e,bottom:D,right:a}=n.getBoundingClientRect(),{innerHeight:r,innerWidth:I}=window;return t>=0&&a<=I&&D<=r&&e>=0})(t)||(t.scrollIntoView({block:"center",behavior:"smooth"}),t.classList.add(P.a.tabItemActive),setTimeout((()=>t.classList.remove(P.a.tabItemActive)),2e3))}),150))},b=n=>{var t;let e;switch(n.keyCode){case U:const t=N.indexOf(n.target)+1;e=N[t]||N[0];break;case o:const D=N.indexOf(n.target)-1;e=N[D]||N[N.length-1]}null===(t=e)||void 0===t||t.focus()};return a.a.createElement("div",{className:"tabs-container"},a.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(I.a)("tabs",{"tabs--block":e},s)},l.map((({value:n,label:t})=>a.a.createElement("li",{role:"tab",tabIndex:d===n?0:-1,"aria-selected":d===n,className:Object(I.a)("tabs__item",P.a.tabItem,{"tabs__item--active":d===n}),key:n,ref:n=>N.push(n),onKeyDown:b,onFocus:p,onClick:p},t)))),t?Object(D.cloneElement)(u.filter((n=>n.props.value===d))[0],{className:"margin-vert--md"}):a.a.createElement("div",{className:"margin-vert--md"},u.map(((n,t)=>Object(D.cloneElement)(n,{key:t,hidden:n.props.value!==d})))))}},253:function(n,t,e){"use strict";var D=e(0),a=e.n(D);t.a=function({children:n,hidden:t,className:e}){return a.a.createElement("div",{role:"tabpanel",hidden:t,className:e},n)}},263:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}(e(0)).createContext({MathJax:null,registerNode:function(){}});t.default=D},284:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=r(e(285)),a=r(e(287));function r(n){return n&&n.__esModule?n:{default:n}}var I={Provider:D.default,Node:a.default};t.default=I},285:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=function(){function n(n,t){for(var e=0;e<t.length;e++){var D=t[e];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(n,D.key,D)}}return function(t,e,D){return e&&n(t.prototype,e),D&&n(t,D),t}}(),a=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}(e(0)),r=i(e(286)),I=i(e(263));function i(n){return n&&n.__esModule?n:{default:n}}var P=function(n){function t(n){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return e.hasNodes=!1,e.loaded=!1,e.registerNode=function(){e.hasNodes=!0},e.load=function(){var n=e.props.script;!e.loaded&&e.hasNodes&&(e.loaded=!0,n?(0,r.default)(n,e.onLoad):e.onLoad(null))},e.onLoad=function(n){var t=e.props.options;MathJax.Hub.Config(t),e.setState({MathJax:MathJax})},e.state={MathJax:null,registerNode:e.registerNode},e}return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}(t,n),D(t,[{key:"componentDidMount",value:function(){this.load()}},{key:"componentDidUpdate",value:function(){this.load()}},{key:"render",value:function(){var n=this.props.children;return a.createElement(I.default.Provider,{value:this.state},n)}}]),t}(a.Component);P.defaultProps={script:"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML",options:{tex2jax:{inlineMath:[]},showMathMenu:!1,showMathMenuMSIE:!1}},t.default=P},286:function(n,t){function e(n,t){n.onload=function(){this.onerror=this.onload=null,t(null,n)},n.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),n)}}function D(n,t){n.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,n))}}n.exports=function(n,t,a){var r=document.head||document.getElementsByTagName("head")[0],I=document.createElement("script");"function"==typeof t&&(a=t,t={}),t=t||{},a=a||function(){},I.type=t.type||"text/javascript",I.charset=t.charset||"utf8",I.async=!("async"in t)||!!t.async,I.src=n,t.attrs&&function(n,t){for(var e in t)n.setAttribute(e,t[e])}(I,t.attrs),t.text&&(I.text=""+t.text),("onload"in I?e:D)(I,a),I.onload||e(I,a),r.appendChild(I)}},287:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var D in e)Object.prototype.hasOwnProperty.call(e,D)&&(n[D]=e[D])}return n},a=function(){function n(n,t){for(var e=0;e<t.length;e++){var D=t[e];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(n,D.key,D)}}return function(t,e,D){return e&&n(t.prototype,e),D&&n(t,D),t}}(),r=function(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}(e(0)),I=P(e(263)),i=P(e(288));function P(n){return n&&n.__esModule?n:{default:n}}function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function U(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?n:t}function l(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var A=function(n){function t(){var n,e,D;o(this,t);for(var a=arguments.length,I=Array(a),i=0;i<a;i++)I[i]=arguments[i];return e=D=U(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this].concat(I))),D.container=r.createRef(),U(D,e)}return l(t,n),a(t,[{key:"componentDidMount",value:function(){this.typeset()}},{key:"componentDidUpdate",value:function(n){var t=n.inline!=this.props.inline;this.typeset(t)}},{key:"componentWillUnmount",value:function(){this.clear()}},{key:"clear",value:function(){var n=this.props.MathJax;if(this.script&&n){var t=n.Hub.getJaxFor(this.script);t&&t.Remove()}}},{key:"typeset",value:function(n){var t=this,e=this.props,D=e.MathJax,a=e.formula,r=e.onRender;if(D)if(n&&this.clear(),!n&&this.script)D.Hub.Queue((function(){var n=D.Hub.getJaxFor(t.script);if(n)n.Text(a,r);else{var e=t.setScriptText(a);(0,i.default)(D,e,r)}}));else{var I=this.setScriptText(a);(0,i.default)(D,I,r)}}},{key:"setScriptText",value:function(n){var t=this.props.inline;return this.script||(this.script=document.createElement("script"),this.script.type="math/tex; "+(t?"":"mode=display"),this.container.current.appendChild(this.script)),"text"in this.script?this.script.text=n:this.script.textContent=n,this.script}},{key:"render",value:function(){var n=this.props,t=(n.MathJax,n.formula,n.inline,n.onRender,function(n,t){var e={};for(var D in n)t.indexOf(D)>=0||Object.prototype.hasOwnProperty.call(n,D)&&(e[D]=n[D]);return e}(n,["MathJax","formula","inline","onRender"]));return this.props.inline?r.createElement("span",D({ref:this.container},t)):r.createElement("div",D({ref:this.container},t))}}]),t}(r.Component);A.defaultProps={inline:!1,onRender:function(){}};var s=function(n){function t(){return o(this,t),U(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return l(t,n),a(t,[{key:"render",value:function(){var n=this;return r.createElement(I.default.Consumer,null,(function(t){var e=t.MathJax;return(0,t.registerNode)(),e?r.createElement(A,D({},n.props,{MathJax:e})):null}))}}]),t}(r.PureComponent);t.default=s},288:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var D=[],a=[],r=!1;t.default=function(n,t,e){D.push(t),a.push(e),r||(r=!0,setTimeout((function(){return function(n){n.Hub.Queue((function(){var t=n.Hub.elementScripts;n.Hub.elementScripts=function(n){return D};try{return n.Hub.Process(null,(function(){a.forEach((function(n){n()})),D=[],a=[],r=!1}))}catch(e){throw e}finally{n.Hub.elementScripts=t}}))}(n)}),0))}}}]);