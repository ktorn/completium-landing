(self.webpackChunkcompletium_landing=self.webpackChunkcompletium_landing||[]).push([[3034],{6105:function(t,e,a){"use strict";a.r(e),a.d(e,{frontMatter:function(){return d},contentTitle:function(){return c},metadata:function(){return s},toc:function(){return u},default:function(){return m}});var n=a(2122),o=a(9756),r=(a(7294),a(3905)),i=a(6742),l=["components"],d={id:"tuto4",title:"Dates and durations",sidebar_label:"4. Dates & Durations",slug:"/contract/tuto/archetype-datedur",hide_title:!0},c=void 0,s={unversionedId:"contract/tuto/tuto4",id:"contract/tuto/tuto4",isDocsHomePage:!1,title:"Dates and durations",description:"Dates & durations",source:"@site/docs/contract/tuto/tuto4.md",sourceDirName:"contract/tuto",slug:"/contract/tuto/archetype-datedur",permalink:"/docs/contract/tuto/archetype-datedur",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/contract/tuto/tuto4.md",version:"current",frontMatter:{id:"tuto4",title:"Dates and durations",sidebar_label:"4. Dates & Durations",slug:"/contract/tuto/archetype-datedur",hide_title:!0},sidebar:"contract",previous:{title:"3. Rationals & Transfers",permalink:"/docs/contract/tuto/archetype-rattrans"},next:{title:"5. Dates arithmetic",permalink:"/docs/contract/tuto/archetype-datearith"}},u=[{value:"Dates &amp; durations",id:"dates--durations",children:[{value:"Deploy",id:"deploy",children:[]},{value:"Call entry point",id:"call-entry-point",children:[]},{value:"Next",id:"next",children:[]}]}],p={toc:u};function m(t){var e=t.components,a=(0,o.Z)(t,l);return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"dates--durations"},"Dates & durations"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"date")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"duration")," types are convenient to establish time related business logic."),(0,r.kt)("p",null,"The call to the entry point succeeds if the contract was created more than 5 minutes and 10 seconds ago; the contract balance must be transferred to caller:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-archetype",metastring:'{6-11} title="4-time_window.arl"',"{6-11}":!0,title:'"4-time_window.arl"'},"archetype time_window\n\nvariable creation : date = now\n\nentry payback_after_period () {\n  require {\n      r1: now > creation + 5m10s\n  }\n  effect {\n      transfer balance to caller\n  }\n}\n")),(0,r.kt)("p",null,"We note that durations may be added or subtracted to dates, and can be compared."),(0,r.kt)("p",null,"There are several ways to initialize dates and durations:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-archetype"},"var d : duration = 3w8d4h34m18s; (* 3 weeks 8 days 4 hours 34 minutes 18 seconds *)\nvar date0 : date = 2019-01-01;                (* iso 8601 *)\nvar date1 : date = 2019-01-01T01:02:03;       (* iso 8601 *)\nvar date2 : date = 2019-01-01T01:02:03Z;      (* iso 8601 *)\nvar date3 : date = 2019-01-01T00:00:00+01:00; (* iso 8601 *)\nvar date4 : date = 2019-01-01T00:00:00-05:30; (* iso 8601 *)\n")),(0,r.kt)("h3",{id:"deploy"},"Deploy"),(0,r.kt)("p",null,"The following ",(0,r.kt)(i.Z,{to:"/docs/cli",mdxType:"Link"},"Completium CLI")," command deploys the contract on the Tezos network:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"completium-cli deploy 4-time_window.arl --amount 5tz\n")),(0,r.kt)("p",null,"Note here that the contract's balance is intialized to 5tz."),(0,r.kt)("h3",{id:"call-entry-point"},"Call entry point"),(0,r.kt)("p",null,"The following command calls the unique entry point:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"completium-cli call 4-time_window\n")),(0,r.kt)("p",null,"If you try this command before valid timelapse of 5 minutes and 10 seconds, it returns an error displayed below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'$ completium-cli call 4-time_window\nError from contract KT1HEH4Hff6Dq53PsoaX18wnkx1bVaPKnZGH (4-time_window):\nfailed at 41 with (Pair "InvalidCondition" "r1")\n')),(0,r.kt)("h3",{id:"next"},"Next"),(0,r.kt)("p",null,"Open '5-weekday.arl' and click on \"Next: Dates arithmetic\" below."))}m.isMDXComponent=!0}}]);