(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{229:function(t,e,n){"use strict";n.r(e),n.d(e,"frontMatter",(function(){return c})),n.d(e,"metadata",(function(){return s})),n.d(e,"toc",(function(){return d})),n.d(e,"default",(function(){return l}));var r=n(3),o=(n(0),n(238)),i=n(241),a=n(242),p=n(239);const c={id:"iot40",title:"Interrupt",sidebar_label:"Interrupt",slug:"/dapp-iot/interrupt"},s={unversionedId:"dapp-iot/iot40",id:"dapp-iot/iot40",isDocsHomePage:!1,title:"Interrupt",description:'It is possible to interrupt the service by clicking the "Interrupt" button:',source:"@site/docs/dapp-iot/iot40.md",slug:"/dapp-iot/interrupt",permalink:"/docs/dapp-iot/interrupt",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/dapp-iot/iot40.md",version:"current",sidebar_label:"Interrupt",sidebar:"dapps",previous:{title:"Switch on",permalink:"/docs/dapp-iot/switchon"},next:{title:"Technical guide presentation",permalink:"/docs/dapp-iot/tg-presentation"}},d=[],u={toc:d};function l({components:t,...e}){return Object(o.b)("wrapper",Object(r.a)({},u,e,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,'It is possible to interrupt the service by clicking the "Interrupt" button:'),Object(o.b)(i.a,{img:"iot-duration.png",width:"60%",mdxType:"DappFigure"}),Object(o.b)("p",null,"It generates the following transaction parameter:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-json"},'[{\n    "kind":"transaction"\n    "to":"KT1CxHBiCSvmXn9kXCbhPfdGDAggGG9ktQEX"\n    "amount":0\n    "mutez":true\n    "parameter":{\n        "entrypoint":"interrupt"\n        "value":{\n            "prim":"Unit"\n        }\n    }\n}]\n')),Object(o.b)("p",null,"It is possible to check the corresponding transactions in the ",Object(o.b)(p.a,{to:"/docs/dapp-tools/bcd",mdxType:"Link"},"Better Call Dev")," indexer:"),Object(o.b)(i.a,{img:"iot-bcd.png",width:"100%",mdxType:"DappFigure"}),Object(o.b)("p",null,"We note in the screenshot above that the smart contract pays back to the ",Object(o.b)("em",{parentName:"p"},"caller")," an amount in prorata of the session duration, as formulated in the smart contract ",Object(o.b)(p.a,{to:"/docs/dapp-iot/implementation#interrupt",mdxType:"Link"},"interrupt")," entry point:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-archetype",metastring:"{2,11}","{2,11}":!0},"function get_return_tz () : tez {\n    var res : int = 1 / get_rate_in_s_by_utz() * (dateofstop - now);\n    return (res * 1utz)\n}\n\nentry interrupt () {\n    require {\n        r2: caller = opt_get(user) and now < dateofstop\n    }\n    effect {\n        transfer (get_return_tz()) to caller;\n        dateofstop  := now - read_interval;\n        dateofstart := now - read_interval;\n    }\n}\n")),Object(o.b)(a.a,{url:"https://better-call.dev/delphinet/KT1CxHBiCSvmXn9kXCbhPfdGDAggGG9ktQEX/operations",txt:"open contract",mdxType:"DappButton"}))}l.isMDXComponent=!0}}]);