(self.webpackChunkcompletium_landing=self.webpackChunkcompletium_landing||[]).push([[4757],{6149:function(t,e,n){"use strict";n.r(e),n.d(e,{frontMatter:function(){return c},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return d},default:function(){return h}});var r=n(2122),o=n(9756),a=(n(7294),n(3905)),i=n(6742),l=n(8820),u=["components"],c={id:"tuto5",title:"Date arithmetic",sidebar_label:"5. Dates arithmetic",slug:"/contract/tuto/archetype-datearith",hide_title:!0},s=void 0,p={unversionedId:"contract/tuto/tuto5",id:"contract/tuto/tuto5",isDocsHomePage:!1,title:"Date arithmetic",description:"Dates arithmetic",source:"@site/docs/contract/tuto/tuto5.md",sourceDirName:"contract/tuto",slug:"/contract/tuto/archetype-datearith",permalink:"/docs/contract/tuto/archetype-datearith",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/contract/tuto/tuto5.md",version:"current",frontMatter:{id:"tuto5",title:"Date arithmetic",sidebar_label:"5. Dates arithmetic",slug:"/contract/tuto/archetype-datearith",hide_title:!0},sidebar:"contract",previous:{title:"4. Dates & Durations",permalink:"/docs/contract/tuto/archetype-datedur"},next:{title:"6. State Machine",permalink:"/docs/contract/tuto/archetype-statem"}},d=[{value:"Dates arithmetic",id:"dates-arithmetic",children:[{value:"Deploy",id:"deploy",children:[]},{value:"Call entry point",id:"call-entry-point",children:[]},{value:"Next",id:"next",children:[]}]}],f={toc:d};function h(t){var e=t.components,n=(0,o.Z)(t,u);return(0,a.kt)("wrapper",(0,r.Z)({},f,n,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"dates-arithmetic"},"Dates arithmetic"),(0,a.kt)("p",null,"Standard arithmetic operations are available on dates."),(0,a.kt)("p",null,"Convert a date to a day of week, so that:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"0 if sunday"),(0,a.kt)("li",{parentName:"ul"},"1 if monday"),(0,a.kt)("li",{parentName:"ul"},"2 if tuesday"),(0,a.kt)("li",{parentName:"ul"},"3 if wednesday"),(0,a.kt)("li",{parentName:"ul"},"4 if thursday"),(0,a.kt)("li",{parentName:"ul"},"5 if friday"),(0,a.kt)("li",{parentName:"ul"},"6 if saturday")),(0,a.kt)("p",null,"The formula to implement is:"),(0,a.kt)(l.Z.Provider,null,(0,a.kt)(l.Z.Node,{formula:"n = \\lfloor\\frac{(d + 4d) \\mod 1w}{1d}\\rfloor"})),(0,a.kt)("p",null,"where:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"d")," is the date to compute the day of"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"4d")," is the duration of four days"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"1w")," is the duration of one week"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("em",{parentName:"li"},"mod")," is the modulo operator: it translates to ",(0,a.kt)("inlineCode",{parentName:"li"},"%")," operator"),(0,a.kt)("li",{parentName:"ul"},"\u230a X \u230b is the floor function")),(0,a.kt)("p",null,"The euclidean division ",(0,a.kt)("inlineCode",{parentName:"p"},"div")," will efficiently implement the floor and division operations."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-archetype",metastring:'{6} title="5-weekday.arl"',"{6}":!0,title:'"5-weekday.arl"'},"archetype weekday\n\nvariable n : int = 0\n\nentry weekday (d : date) {\n    n := (((d - 1970-01-01) + 4d) % 1w) div 1d\n}\n")),(0,a.kt)("h3",{id:"deploy"},"Deploy"),(0,a.kt)("p",null,"The following ",(0,a.kt)(i.Z,{to:"/docs/cli",mdxType:"Link"},"Completium CLI")," command deploys the contract on the Tezos network:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"completium-cli deploy 5-weekday.arl\n")),(0,a.kt)("h3",{id:"call-entry-point"},"Call entry point"),(0,a.kt)("p",null,"The following command calls the unique entry point:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'completium-cli call 5-weekday --arg  \'{ "d" : "2008-11-28" }\'\n')),(0,a.kt)("h3",{id:"next"},"Next"),(0,a.kt)("p",null,"Open '6-state_machine.arl' and click on \"Next: State Machine\" below."))}h.isMDXComponent=!0},9090:function(t){function e(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function n(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}t.exports=function(t,r,o){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");"function"==typeof r&&(o=r,r={}),r=r||{},o=o||function(){},i.type=r.type||"text/javascript",i.charset=r.charset||"utf8",i.async=!("async"in r)||!!r.async,i.src=t,r.attrs&&function(t,e){for(var n in e)t.setAttribute(n,e[n])}(i,r.attrs),r.text&&(i.text=""+r.text),("onload"in i?e:n)(i,o),i.onload||e(i,o),a.appendChild(i)}},2470:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7294)),i=u(n(8195)),l=u(n(7680));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var d=function(t){function e(){var t,n,r;c(this,e);for(var o=arguments.length,i=Array(o),l=0;l<o;l++)i[l]=arguments[l];return n=r=s(this,(t=e.__proto__||Object.getPrototypeOf(e)).call.apply(t,[this].concat(i))),r.container=a.createRef(),s(r,n)}return p(e,t),o(e,[{key:"componentDidMount",value:function(){this.typeset()}},{key:"componentDidUpdate",value:function(t){var e=t.inline!=this.props.inline;this.typeset(e)}},{key:"componentWillUnmount",value:function(){this.clear()}},{key:"clear",value:function(){var t=this.props.MathJax;if(this.script&&t){var e=t.Hub.getJaxFor(this.script);e&&e.Remove()}}},{key:"typeset",value:function(t){var e=this,n=this.props,r=n.MathJax,o=n.formula,a=n.onRender;if(r)if(t&&this.clear(),!t&&this.script)r.Hub.Queue((function(){var t=r.Hub.getJaxFor(e.script);if(t)t.Text(o,a);else{var n=e.setScriptText(o);(0,l.default)(r,n,a)}}));else{var i=this.setScriptText(o);(0,l.default)(r,i,a)}}},{key:"setScriptText",value:function(t){var e=this.props.inline;return this.script||(this.script=document.createElement("script"),this.script.type="math/tex; "+(e?"":"mode=display"),this.container.current.appendChild(this.script)),"text"in this.script?this.script.text=t:this.script.textContent=t,this.script}},{key:"render",value:function(){var t=this.props,e=(t.MathJax,t.formula,t.inline,t.onRender,function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["MathJax","formula","inline","onRender"]));return this.props.inline?a.createElement("span",r({ref:this.container},e)):a.createElement("div",r({ref:this.container},e))}}]),e}(a.Component);d.defaultProps={inline:!1,onRender:function(){}};var f=function(t){function e(){return c(this,e),s(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return p(e,t),o(e,[{key:"render",value:function(){var t=this;return a.createElement(i.default.Consumer,null,(function(e){var n=e.MathJax;return(0,e.registerNode)(),n?a.createElement(d,r({},t.props,{MathJax:n})):null}))}}]),e}(a.PureComponent);e.default=f},4741:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7294)),a=l(n(9090)),i=l(n(8195));function l(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.hasNodes=!1,n.loaded=!1,n.registerNode=function(){n.hasNodes=!0},n.load=function(){var t=n.props.script;!n.loaded&&n.hasNodes&&(n.loaded=!0,t?(0,a.default)(t,n.onLoad):n.onLoad(null))},n.onLoad=function(t){var e=n.props.options;MathJax.Hub.Config(e),n.setState({MathJax:MathJax})},n.state={MathJax:null,registerNode:n.registerNode},n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"componentDidMount",value:function(){this.load()}},{key:"componentDidUpdate",value:function(){this.load()}},{key:"render",value:function(){var t=this.props.children;return o.createElement(i.default.Provider,{value:this.state},t)}}]),e}(o.Component);u.defaultProps={script:"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML",options:{tex2jax:{inlineMath:[]},showMathMenu:!1,showMathMenuMSIE:!1}},e.default=u},8195:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(7294)).createContext({MathJax:null,registerNode:function(){}});e.default=r},8820:function(t,e,n){"use strict";var r=a(n(4741)),o=a(n(2470));function a(t){return t&&t.__esModule?t:{default:t}}var i={Provider:r.default,Node:o.default};e.Z=i},7680:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=[],r=[],o=!1;e.default=function(t,e,a){n.push(e),r.push(a),o||(o=!0,setTimeout((function(){return function(t){t.Hub.Queue((function(){var e=t.Hub.elementScripts;t.Hub.elementScripts=function(t){return n};try{return t.Hub.Process(null,(function(){r.forEach((function(t){t()})),n=[],r=[],o=!1}))}catch(a){throw a}finally{t.Hub.elementScripts=e}}))}(t)}),0))}}}]);