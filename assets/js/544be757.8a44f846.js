(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{133:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return r})),n.d(t,"default",(function(){return s}));var i=n(3),o=(n(0),n(238)),c=n(239);const a={id:"tuto2",title:"Execution Conditions",sidebar_label:"2. Execution conditions",slug:"/contract/tuto/archetype-execcond",hide_title:!0},l={unversionedId:"contract/tuto/tuto2",id:"contract/tuto/tuto2",isDocsHomePage:!1,title:"Execution Conditions",description:"Execution conditions",source:"@site/docs/contract/tuto/tuto2.md",slug:"/contract/tuto/archetype-execcond",permalink:"/docs/contract/tuto/archetype-execcond",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/contract/tuto/tuto2.md",version:"current",sidebar_label:"2. Execution conditions",sidebar:"contract",previous:{title:"Hello Tezos world",permalink:"/docs/contract/tuto/archetype-hello"},next:{title:"Rationals and transfers",permalink:"/docs/contract/tuto/archetype-rattrans"}},r=[{value:"Execution conditions",id:"execution-conditions",children:[{value:"Deploy",id:"deploy",children:[]},{value:"Call entry point",id:"call-entry-point",children:[]}]},{value:"View contract",id:"view-contract",children:[{value:"Next",id:"next",children:[]}]}],d={toc:r};function s({components:e,...t}){return Object(o.b)("wrapper",Object(i.a)({},d,t,{components:e,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"execution-conditions"},"Execution conditions"),Object(o.b)("p",null,"In this exercise, the entry point may only be called by the ",Object(o.b)("inlineCode",{parentName:"p"},"admin")," address; it also requires:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"that the argument value ",Object(o.b)("inlineCode",{parentName:"li"},"v")," be between 10 (included) and 20 (strictly)"),Object(o.b)("li",{parentName:"ul"},"be even")),Object(o.b)("p",null,"If not even, it must fail with this following message : ",Object(o.b)("inlineCode",{parentName:"p"},"Expected even value"),":"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-archetype",metastring:'{8,10,11} title="2-exec-condition.arl"',"{8,10,11}":!0,title:'"2-exec-condition.arl"'},'archetype exec_condition\n\nvariable value : nat = 0\n\nconstant admin : address = @tz1MZrh8CvYkp7BfLQMcm6mg5FvL5HRZfACw\n\nentry main(v : nat) {\n  called by admin\n  require {\n      r1: 10 <= v < 20;\n      r2 otherwise "EXPECTED EVEN VALUE": value % 2 = 0\n  }\n  effect {\n     value := v;\n  }\n}\n')),Object(o.b)("p",null,"It is also possible to establish execution conditions with a ",Object(o.b)("inlineCode",{parentName:"p"},"failif")," section.\nExecution conditions have identifiers (here ",Object(o.b)("inlineCode",{parentName:"p"},"r1")," and ",Object(o.b)("inlineCode",{parentName:"p"},"r2"),") used for fail message when no ",Object(o.b)("inlineCode",{parentName:"p"},"otherwise")," is established, and to name the property in contract formal verification."),Object(o.b)("p",null,"One of the key requirements of a smart contract's entry point is to establish execution conditions:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Who can call the contract?"),Object(o.b)("li",{parentName:"ul"},"Under which logical conditions?")),Object(o.b)("p",null,"Archetype provides dedicated syntax to make execution conditions very explicit and non ambiguous."),Object(o.b)("h3",{id:"deploy"},"Deploy"),Object(o.b)("p",null,"The following ",Object(o.b)(c.a,{to:"/docs/cli",mdxType:"Link"},"Completium CLI")," command deploys the contract on the Tezos network:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"completium-cli deploy 2-exec_condition.arl\n")),Object(o.b)("h3",{id:"call-entry-point"},"Call entry point"),Object(o.b)("p",null,"The following command calls the unique entry point with the argument ",Object(o.b)("inlineCode",{parentName:"p"},"14")," using the ",Object(o.b)("inlineCode",{parentName:"p"},"--with")," option:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"completium-cli call 2-exec-condition --with '14'\n")),Object(o.b)("h2",{id:"view-contract"},"View contract"),Object(o.b)("p",null,"The following command generates the URL to view the contract in Better call Dev:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"completium-cli show contract 2-exec-condition\n")),Object(o.b)("h3",{id:"next"},"Next"),Object(o.b)("p",null,"Open '3-rat_transfer.arl' and click on \"Next: Rationals & transfers\" below."))}s.isMDXComponent=!0}}]);