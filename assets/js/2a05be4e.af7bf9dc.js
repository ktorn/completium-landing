(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{101:function(n,e,t){"use strict";t.r(e),t.d(e,"frontMatter",(function(){return r})),t.d(e,"metadata",(function(){return s})),t.d(e,"toc",(function(){return l})),t.d(e,"default",(function(){return i}));var a=t(3),o=(t(0),t(238));t(240),t(241),t(242);const r={id:"nonfungible7",title:"Interactions",sidebar_label:"Interactions",slug:"/dapp-nonfungible/interactions"},s={unversionedId:"dapp-nonfungible/nonfungible7",id:"dapp-nonfungible/nonfungible7",isDocsHomePage:!1,title:"Interactions",description:"Read storage",source:"@site/docs/dapp-nonfungible/nonfungible7.md",slug:"/dapp-nonfungible/interactions",permalink:"/docs/dapp-nonfungible/interactions",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/dapp-nonfungible/nonfungible7.md",version:"current",sidebar_label:"Interactions",sidebar:"dapps",previous:{title:"Contract Origination",permalink:"/docs/dapp-nonfungible/origination"},next:{title:"Decentralised Exchange",permalink:"/docs/dapp-dex"}},l=[{value:"Read storage",id:"read-storage",children:[]},{value:"Sell transacation",id:"sell-transacation",children:[]},{value:"Buy transaction",id:"buy-transaction",children:[]}],c={toc:l};function i({components:n,...e}){return Object(o.b)("wrapper",Object(a.a)({},c,e,{components:n,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"read-storage"},"Read storage"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"src/Apps.js")," line 62"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"if (!isReady()) {\n    ///////////////////////////////////////////////////////////////////////////\n    // FIX ME\n    // Read conract storage:\n    // * forsales : the list of item for sales\n    // * botwallet : list of purchased items\n    // call 'setNonFungibleState' to set UI state\n    ///////////////////////////////////////////////////////////////////////////\n}\n")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"Tezos.contract\n.at(contractAddress)\n.then(contract => {\n  contract.storage().then(storage => {\n    var forsales = [];\n    var botwallet = [];\n    // operator is an array\n    storage.operator.forEach(element => {\n      forsales.push(element[1].toString());\n    });\n    // ledger is a map\n    // read ledger for ownership information\n    if (ready) {\n      storage.ledger.forEach((l,k,m) => {\n        if(l === accountAddress) {\n          botwallet.push(k);\n        }\n      })\n    }\n    setNonFungibleState({\n      forsales  : forsales,\n      botwallet : botwallet,\n      basket    : nonFungibleState.basket,\n      ready     : true\n    });\n  })\n})\n.catch(error => console.log(`Error: ${error}`));\n")),Object(o.b)("h2",{id:"sell-transacation"},"Sell transacation"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"src/components/Robots.js")," line"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const handleSell = () => {\n    ///////////////////////////////////////////////////////////////////////////\n    // FIX ME\n    // Call 'sell' entry point\n    ///////////////////////////////////////////////////////////////////////////\n}\n")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"tezos.wallet.at(contractAddress).then(contract => {\n      contract.methods.sell(props.data.id).send().then(op => {\n        props.openSnack();\n        op.receipt().then(() => {\n          props.closeSnack();\n          setNotReady();\n        })\n      })\n});\n")),Object(o.b)("h2",{id:"buy-transaction"},"Buy transaction"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"src/components/Account.js")," line 76"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"const handleBuy = () => {\n    ///////////////////////////////////////////////////////////////////////////\n    // FIX ME\n    // Call 'buy' entry point\n    ///////////////////////////////////////////////////////////////////////////\n    setOpen(false);\n}\n")),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-js"},"tezos.wallet.at(contractAddress).then(contract => {\n    var amount = getTotal(robotributes, nonFungibleState.basket).toFixed(1);\n    contract.methods.buy(nonFungibleState.basket).send({ amount: amount, mutez: false }).then(op => {\n      props.openSnack();\n      op.receipt().then(() => {\n        props.closeSnack();\n        setNotReady();\n      })\n    })\n});\n")))}i.isMDXComponent=!0},240:function(n,e,t){"use strict";t(0),t(245)}}]);