(window.webpackJsonp=window.webpackJsonp||[]).push([[145],{213:function(r,t,i){"use strict";i.r(t),i.d(t,"frontMatter",(function(){return s})),i.d(t,"metadata",(function(){return c})),i.d(t,"toc",(function(){return l})),i.d(t,"default",(function(){return b}));var e=i(3),n=i(7),a=(i(0),i(227)),p=i(228),m=i(242),o=i(243),s=(i(357),{id:"template10",title:"Auction",sidebar_label:"Auction",slug:"/templates/auction"}),c={unversionedId:"templates/template10",id:"templates/template10",isDocsHomePage:!1,title:"Auction",description:"Introduction",source:"@site/docs/templates/template10.md",slug:"/templates/auction",permalink:"/docs/templates/auction",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/templates/template10.md",version:"current",sidebar_label:"Auction",sidebar:"templates",previous:{title:"Competition",permalink:"/docs/templates/competition"}},l=[{value:"Introduction",id:"introduction",children:[]},{value:"API",id:"api",children:[{value:"Storage",id:"storage",children:[]},{value:"Entrypoints",id:"entrypoints",children:[]}]},{value:"Code",id:"code",children:[]}],d={toc:l};function b(r){var t=r.components,i=Object(n.a)(r,["components"]);return Object(a.b)("wrapper",Object(e.a)({},d,i,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h2",{id:"introduction"},"Introduction"),Object(a.b)("p",null,"Auction process to transfer a ",Object(a.b)(p.a,{to:"/docs/templates/nft",mdxType:"Link"},"FA2 NFT")," to best bidder."),Object(a.b)("p",null,"The best bid is escrowed by the contract til ownership is claimed. Previous best bidder gets its bid back. When asset ownership claimed, it is transfered to asset owner."),Object(a.b)("p",null,"The contract calls the FA2 contract to check NFT ownership, and transfer ownership when auction is over."),Object(a.b)("p",null,"The benefit of splitting the auction process from the FA2 ledger is that it makes it possible to change or select the appropriate auction process, while keeping the ledger intact."),Object(a.b)("h2",{id:"api"},"API"),Object(a.b)("h3",{id:"storage"},"Storage"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",Object(e.a)({parentName:"tr"},{align:null}),"Name"),Object(a.b)("th",Object(e.a)({parentName:"tr"},{align:null}),"Type"),Object(a.b)("th",Object(e.a)({parentName:"tr"},{align:null}),"Description"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"assetid")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"bytes")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Id of sold item.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"owner")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"address")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Address to collect best bid.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"auction_dur")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"duration")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Auction duration.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"dur_incr")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"duration")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Increment of auction duration when a bid is placed.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"nft")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"collection")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"An NFT auction is defined by:",Object(a.b)("ul",null,Object(a.b)("li",null,"nft id"),Object(a.b)("li",null,Object(a.b)("inlineCode",{parentName:"td"},"owner")," of the NFT"),Object(a.b)("li",null,Object(a.b)("inlineCode",{parentName:"td"},"bestbidder")," option of address of best bidder"),Object(a.b)("li",null,Object(a.b)("inlineCode",{parentName:"td"},"best")," best bid amount"),Object(a.b)("li",null,Object(a.b)("inlineCode",{parentName:"td"},"endofbid")," date of the end of bid")))))),Object(a.b)("h3",{id:"entrypoints"},"Entrypoints"),Object(a.b)("p",null,"The transfer of ownership performed by ",Object(a.b)("inlineCode",{parentName:"p"},"calim")," supposes that the NFT owner calls the ",Object(a.b)("inlineCode",{parentName:"p"},"update_operators")," entrypoint of the ",Object(a.b)(p.a,{to:"/docs/templates/nft",mdxType:"Link"},"FA2 contract"),"."),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",Object(e.a)({parentName:"tr"},{align:null}),"Name"),Object(a.b)("th",Object(e.a)({parentName:"tr"},{align:null}),"Parameters"),Object(a.b)("th",Object(e.a)({parentName:"tr"},{align:null}),"Description"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"upforsale")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"id"),", ",Object(a.b)("inlineCode",{parentName:"td"},"price")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Owner sets the NFT ",Object(a.b)("inlineCode",{parentName:"td"},"id")," up for sale. ",Object(a.b)("p",null),"Sets date of end of bid to ",Object(a.b)("inlineCode",{parentName:"td"},"now + auction_dur"),". ",Object(a.b)("p",null),"FA2 NFT contract entrypoint ",Object(a.b)("inlineCode",{parentName:"td"},"balance_of")," is called to check that caller is the owner of NFT ",Object(a.b)("inlineCode",{parentName:"td"},"id"),".")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"bid")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"id")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Places a bid for NFT ",Object(a.b)("inlineCode",{parentName:"td"},"id"),". Bid amount is transferred. ",Object(a.b)("p",null),"If this is best bid, previous best bid amount is transferred back to previous bet bidder.")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"claim")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"id")),Object(a.b)("td",Object(e.a)({parentName:"tr"},{align:null}),"Transfers escrowed bid amount to ",Object(a.b)("inlineCode",{parentName:"td"},"owner")," if auction is over for NFT ",Object(a.b)("inlineCode",{parentName:"td"},"id"),". New ",Object(a.b)("inlineCode",{parentName:"td"},"owner")," value is set to ",Object(a.b)("inlineCode",{parentName:"td"},"bestbidder"),".",Object(a.b)("p",null),"FA2 NFT contract entrypoint ",Object(a.b)("inlineCode",{parentName:"td"},"transfer")," is called to transfer ownership to best bidder.")))),Object(a.b)("h2",{id:"code"},"Code"),Object(a.b)(m.a,{defaultValue:"archetype",values:[{label:"Archetype",value:"archetype"},{label:"Michelson",value:"michelson"}],mdxType:"Tabs"},Object(a.b)(o.a,{value:"archetype",mdxType:"TabItem"},Object(a.b)("pre",null,Object(a.b)("code",Object(e.a)({parentName:"pre"},{className:"language-archetype",metastring:'title="auction.arl"',title:'"auction.arl"'}),'\narchetype auction(\n  nftoken     : address,\n  auction_dur : duration,\n  dur_incr    : duration\n)\n\nasset nft {\n  nftid      : nat;\n  owner      : address;\n  bestbidder : option<address>;\n  best       : tez;\n  endofbid   : date;\n}\n\nrecord operator_param {\n  opp_owner    : address;\n  opp_operator : address;\n  opp_token_id : nat\n} as ((owner, (operator, token_id)))\n\nrecord balance_of_request {\n  bo_owner : address;\n  btoken_id : nat;\n} as ((owner, token_id))\n\nrecord balance_of_response {\n  request : balance_of_request;\n  balance_ : nat;\n} as ((request, balance))\n\nfunction get_addop_param(\n  powner : address,\n  popp   : address,\n  pid    : nat\n) : list<or<operator_param, operator_param>> {\n  return ([\n    left<operator_param>({\n      opp_owner    = powner;\n      opp_operator = popp;\n      opp_token_id = pid\n    })\n  ])\n}\n\nentry check_ownership(brl : list<balance_of_response>) {\n  called by nftoken\n  effect {\n    match brl with\n    | hd::tl -> begin\n      dorequire(hd.balance_ = 1, "Caller Is Not Owner");\n      transfer 0tz to nftoken\n        call update_operators<list<or<operator_param, operator_param>>>(\n          get_addop_param(hd.request.bo_owner, selfaddress, hd.request.btoken_id));\n    end\n    | []     -> fail("Empty Response")\n    end\n  }\n}\n\nentry upforsale (id : nat, price : tez) {\n  require {\n    r1: if nft.contains(id) then nft[id].endofbid < now else true\n  }\n  effect {\n    nft.addupdate(id, {\n      owner      = caller;\n      bestbidder = none;\n      best       = price;\n      endofbid   = (now + auction_dur)\n    });\n    (* check ownership with FA2 balance_of *)\n    transfer 0tz to nftoken\n       call balance_of<\n              list<balance_of_request> *\n              contract<list<balance_of_response>>\n       >(([ { bo_owner = caller; btoken_id = id } ], self.check_ownership));\n  }\n}\n\nentry bid (id : nat) {\n  require {\n    r2 otherwise "No Auction"   : now < nft[id].endofbid;\n    r3 otherwise "Not Best Bid" :\n      if issome(nft[id].bestbidder)\n      then transferred >  nft[id].best\n      else transferred >= nft[id].best;\n  }\n  effect {\n    match nft[id].bestbidder with\n    | none -> ()\n    | some bidder -> transfer nft[id].best to bidder\n    end;\n    nft.update(id, {\n      bestbidder = some(caller);\n      best       = transferred;\n      endofbid  +=\n        (if nft[id].endofbid - now < dur_incr\n         then dur_incr\n         else 0s)\n    })\n  }\n}\n\nrecord transfer_destination {\n  to_dest           : address;\n  token_id_dest     : nat;\n  token_amount_dest : nat\n} as ((to_, (token_id, amount)))\n\nfunction get_transfer_param(\n  %from : address,\n  %to   : address,\n  id    : nat) : list<address * list<transfer_destination>> {\n  return ([\n    (%from, [{\n      to_dest           = %to;\n      token_id_dest     = id;\n      token_amount_dest = 1\n    }])\n  ])\n}\n\nfunction get_rmop_param(\n  powner : address,\n  popp   : address,\n  pid    : nat\n) : list<or<operator_param, operator_param>> {\n  return ([\n    right<operator_param>({\n      opp_owner    = powner;\n      opp_operator = popp;\n      opp_token_id = pid\n    })\n  ])\n}\n\nentry claim (id : nat) {\n  require {\n    r4 otherwise "Auction Is Still On" : nft[id].endofbid < now\n  }\n  effect {\n    transfer 0tz to nftoken\n      call update_operators<list<or<operator_param, operator_param>>>(\n        get_rmop_param(nft[id].owner, selfaddress, id));\n    match nft[id].bestbidder with\n    | none -> ()\n    | some bidder -> begin\n        transfer 0tz to nftoken\n          call %transfer<list<address * list<transfer_destination>>>(\n            get_transfer_param(nft[id].owner, bidder, id));\n        transfer nft[id].best to nft[id].owner;\n      end\n    end;\n    nft.remove(id);\n  }\n}\n'))),Object(a.b)(o.a,{value:"michelson",mdxType:"TabItem"},Object(a.b)("pre",null,Object(a.b)("code",Object(e.a)({parentName:"pre"},{className:"language-js"}),"")))))}b.isMDXComponent=!0},259:function(r,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"f",(function(){return o})),i.d(t,"e",(function(){return s})),i.d(t,"b",(function(){return c})),i.d(t,"d",(function(){return l})),i.d(t,"c",(function(){return d}));var e=i(0),n=i.n(e),a=i(288),p=i(355);const[m,o,s,c,l,d]=Object(a.a)((function({appName:r}){const[{wallet:t,tezos:i,accountPkh:e},a]=n.a.useState((()=>({wallet:null,tezos:null,accountPkh:null}))),m=Boolean(i);n.a.useEffect((()=>p.a.onAvailabilityChange((t=>{a({wallet:t?new p.a(r):null,tezos:null,accountPkh:null})}))),[a,r]);const o=n.a.useCallback((async(r,i)=>{try{if(!t)throw new Error("Thanos Wallet not available");await t.connect(r,i);const e=t.toTezos(),n=await e.wallet.pkh();a({wallet:t,tezos:e,accountPkh:n})}catch(e){alert(`Failed to connect ThanosWallet: ${e.message}`)}}),[a,t]);return{wallet:t,tezos:i,accountPkh:e,ready:m,connect:o}}),(r=>r.wallet),(r=>r.tezos),(r=>r.accountPkh),(r=>r.ready),(r=>r.connect))},261:function(r,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return p}));var e=i(0),n=i(288);const[a,p]=Object(n.a)((function(){const[r,t]=Object(e.useState)({show:!1,severity:"info",msg:""});return{snackState:r,setInfoSnack:r=>{t({show:!0,severity:"info",msg:r})},setErrorSnack:r=>{t({show:!0,severity:"error",msg:r})},hideSnack:()=>{t((r=>({...r,show:!1})))}}}))},306:function(r,t,i){"use strict";var e=i(3),n=i(0),a=i.n(n),p=i(608),m=i(605),o=i(316),s=i(261);function c(r){return a.a.createElement(m.a,Object(e.a)({elevation:6,variant:"filled"},r))}t.a=()=>{const{snackState:r}=Object(s.b)();Object(o.a)();return a.a.createElement(p.a,{open:r.show},a.a.createElement(c,{severity:r.severity},r.msg))}},307:function(r,t,i){"use strict";var e=i(0),n=i.n(e),a=i(259);var p=i(590),m=i(596),o=i(316);t.a=r=>{const t=Object(o.a)(),i=Object(a.d)(),e=Object(a.f)(),s=Object(a.c)(),c=n.a.useCallback((r=>async()=>{try{await s(r?"mainnet":"edo2net")}catch(t){alert(t.message)}}),[s]);return i?n.a.createElement("div",null):e?n.a.createElement(p.a,{variant:"outlined",color:t.palette.text.primary,onClick:c(r.main)},"connect to wallet"):n.a.createElement(m.a,{href:"https://templewallet.com/",rel:"noopener",underline:"none"},n.a.createElement(p.a,{variant:"contained",disableElevation:!0,style:{backgroundColor:"#ed8936",color:"white",fontWeight:"bold"}},"install Temple"))}},333:function(r,t){},334:function(r,t){},345:function(r,t){},346:function(r,t){},349:function(r,t){},350:function(r,t){},354:function(r,t){var i,e;Fraction=function(r,t){if(void 0!==r&&t)"number"==typeof r&&"number"==typeof t?(this.numerator=r,this.denominator=t):"string"==typeof r&&"string"==typeof t&&(this.numerator=parseInt(r),this.denominator=parseInt(t));else if(void 0===t)if(num=r,"number"==typeof num)this.numerator=num,this.denominator=1;else if("string"==typeof num){var i,e,n=num.split(" ");if(n[0]&&(i=n[0]),n[1]&&(e=n[1]),i%1==0&&e&&e.match("/"))return new Fraction(i).add(new Fraction(e));if(!i||e)return;if("string"==typeof i&&i.match("/")){var a=i.split("/");this.numerator=a[0],this.denominator=a[1]}else{if("string"==typeof i&&i.match("."))return new Fraction(parseFloat(i));this.numerator=parseInt(i),this.denominator=1}}this.normalize()},Fraction.prototype.clone=function(){return new Fraction(this.numerator,this.denominator)},Fraction.prototype.toString=function(){if("NaN"===this.denominator)return"NaN";var r=this.numerator/this.denominator>0?Math.floor(this.numerator/this.denominator):Math.ceil(this.numerator/this.denominator),t=this.numerator%this.denominator,i=this.denominator,e=[];return 0!=r&&e.push(r),0!=t&&e.push((0===r?t:Math.abs(t))+"/"+i),e.length>0?e.join(" "):0},Fraction.prototype.rescale=function(r){return this.numerator*=r,this.denominator*=r,this},Fraction.prototype.add=function(r){var t=this.clone();return r=r instanceof Fraction?r.clone():new Fraction(r),td=t.denominator,t.rescale(r.denominator),r.rescale(td),t.numerator+=r.numerator,t.normalize()},Fraction.prototype.subtract=function(r){var t=this.clone();return r=r instanceof Fraction?r.clone():new Fraction(r),td=t.denominator,t.rescale(r.denominator),r.rescale(td),t.numerator-=r.numerator,t.normalize()},Fraction.prototype.multiply=function(r){var t=this.clone();if(r instanceof Fraction)t.numerator*=r.numerator,t.denominator*=r.denominator;else{if("number"!=typeof r)return t.multiply(new Fraction(r));t.numerator*=r}return t.normalize()},Fraction.prototype.divide=function(r){var t=this.clone();if(r instanceof Fraction)t.numerator*=r.denominator,t.denominator*=r.numerator;else{if("number"!=typeof r)return t.divide(new Fraction(r));t.denominator*=r}return t.normalize()},Fraction.prototype.equals=function(r){r instanceof Fraction||(r=new Fraction(r));var t=this.clone().normalize();r=r.clone().normalize();return t.numerator===r.numerator&&t.denominator===r.denominator},Fraction.prototype.normalize=(i=function(r){return"number"==typeof r&&(r>0&&r%1>0&&r%1<1||r<0&&r%-1<0&&r%-1>-1)},e=function(r,t){if(t){var i=Math.pow(10,t);return Math.round(r*i)/i}return Math.round(r)},function(){if(i(this.denominator)){var r=e(this.denominator,9),t=Math.pow(10,r.toString().split(".")[1].length);this.denominator=Math.round(this.denominator*t),this.numerator*=t}i(this.numerator)&&(r=e(this.numerator,9),t=Math.pow(10,r.toString().split(".")[1].length),this.numerator=Math.round(this.numerator*t),this.denominator*=t);var n=Fraction.gcf(this.numerator,this.denominator);return this.numerator/=n,this.denominator/=n,(this.numerator<0&&this.denominator<0||this.numerator>0&&this.denominator<0)&&(this.numerator*=-1,this.denominator*=-1),this}),Fraction.gcf=function(r,t){var i=[],e=Fraction.primeFactors(r),n=Fraction.primeFactors(t);return e.forEach((function(r){var t=n.indexOf(r);t>=0&&(i.push(r),n.splice(t,1))})),0===i.length?1:function(){var r,t=i[0];for(r=1;r<i.length;r++)t*=i[r];return t}()},Fraction.primeFactors=function(r){for(var t=Math.abs(r),i=[],e=2;e*e<=t;)t%e==0?(i.push(e),t/=e):e++;return 1!=t&&i.push(t),i},r.exports.Fraction=Fraction},357:function(r,t,i){"use strict";var e=i(0),n=i.n(e),a=i(384),p=i(386),m=i(603),o=i(387),s=i(590),c=i(550),l=i(588),d=i(259),b=i(306),g=i(261),u=i(307);const P=[{prim:"storage",args:[{prim:"pair",args:[{prim:"address",annots:["%owner"]},{prim:"pair",args:[{prim:"pair",args:[{prim:"int"},{prim:"nat"}],annots:["%rate"]},{prim:"pair",args:[{prim:"timestamp",annots:["%endofservice"]},{prim:"pair",args:[{prim:"timestamp",annots:["%startofservice"]},{prim:"pair",args:[{prim:"int",annots:["%time_unit"]},{prim:"pair",args:[{prim:"mutez",annots:["%tez_unit"]},{prim:"pair",args:[{prim:"option",args:[{prim:"address"}],annots:["%user"]},{prim:"int",annots:["%read_interval"]}]}]}]}]}]}]}]}]},{prim:"parameter",args:[{prim:"or",args:[{prim:"unit",annots:["%start"]},{prim:"or",args:[{prim:"unit",annots:["%interrupt"]},{prim:"or",args:[{prim:"unit",annots:["%collect"]},{prim:"pair",args:[{prim:"int",annots:["%dunit"]},{prim:"mutez",annots:["%tunit"]}],annots:["%setunits"]}]}]}]}]},{prim:"code",args:[[{prim:"LAMBDA",args:[{prim:"pair",args:[{prim:"pair",args:[{prim:"int"},{prim:"nat"}]},{prim:"pair",args:[{prim:"mutez"},{prim:"int"}]}]},{prim:"pair",args:[{prim:"int"},{prim:"nat"}]},[{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"PUSH",args:[{prim:"unit"},{prim:"Unit"}]},{prim:"DIG",args:[{int:"1"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"2"}]},{prim:"PUSH",args:[{prim:"mutez"},{int:"1"}]},{prim:"DIG",args:[{int:"4"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"5"}]},{prim:"EDIV"},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"DivByZero"}]},{prim:"FAILWITH"}],[{prim:"DUP"},{prim:"CAR"},{prim:"SWAP"},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"PUSH",args:[{prim:"nat"},{int:"1"}]},{prim:"DIG",args:[{int:"1"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"2"}]},{prim:"INT"},{prim:"PAIR"},{prim:"PUSH",args:[{prim:"nat"},{int:"1"}]},{prim:"DIG",args:[{int:"3"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"4"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"7"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"8"}]},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"UNPAIR"}]]},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"SWAP"}]]},{prim:"MUL"},{prim:"DIP",args:[{int:"1"},[{prim:"MUL"}]]},{prim:"PAIR"},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"UNPAIR"}]]},{prim:"UNPAIR"},{prim:"DIG",args:[{int:"3"}]},{prim:"PUSH",args:[{prim:"int"},{int:"0"}]},{prim:"DIG",args:[{int:"4"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"5"}]},{prim:"COMPARE"},{prim:"GE"},{prim:"IF",args:[[{prim:"INT"}],[{prim:"NEG"}]]},{prim:"MUL"},{prim:"DIP",args:[{int:"1"},[{prim:"MUL"},{prim:"ABS"}]]},{prim:"PAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"2"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"2"}]},{prim:"DROP",args:[{int:"2"}]},{prim:"DUG",args:[{int:"3"}]},{prim:"DROP",args:[{int:"3"}]}]]},{prim:"LAMBDA",args:[{prim:"pair",args:[{prim:"timestamp"},{prim:"pair",args:[{prim:"pair",args:[{prim:"int"},{prim:"nat"}]},{prim:"pair",args:[{prim:"mutez"},{prim:"pair",args:[{prim:"int"},{prim:"lambda",args:[{prim:"pair",args:[{prim:"pair",args:[{prim:"int"},{prim:"nat"}]},{prim:"pair",args:[{prim:"mutez"},{prim:"int"}]}]},{prim:"pair",args:[{prim:"int"},{prim:"nat"}]}]}]}]}]}]},{prim:"mutez"},[{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"PUSH",args:[{prim:"unit"},{prim:"Unit"}]},{prim:"NOW"},{prim:"DIG",args:[{int:"6"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"7"}]},{prim:"SUB"},{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"DIG",args:[{int:"4"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"5"}]},{prim:"DIG",args:[{int:"6"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"7"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"7"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"8"}]},{prim:"PAIR"},{prim:"EXEC"},{prim:"PUSH",args:[{prim:"nat"},{int:"1"}]},{prim:"PUSH",args:[{prim:"nat"},{int:"1"}]},{prim:"INT"},{prim:"PAIR"},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"UNPAIR"}]]},{prim:"UNPAIR"},{prim:"DIG",args:[{int:"3"}]},{prim:"PUSH",args:[{prim:"int"},{int:"0"}]},{prim:"DIG",args:[{int:"4"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"5"}]},{prim:"COMPARE"},{prim:"GE"},{prim:"IF",args:[[{prim:"INT"}],[{prim:"NEG"}]]},{prim:"MUL"},{prim:"DIP",args:[{int:"1"},[{prim:"MUL"},{prim:"ABS"}]]},{prim:"PAIR"},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"UNPAIR"},{prim:"DIG",args:[{int:"2"}]},{prim:"MUL"},{prim:"EDIV"},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"DivByZero"}]},{prim:"FAILWITH"}],[]]},{prim:"CAR"},{prim:"PUSH",args:[{prim:"mutez"},{int:"1"}]},{prim:"PUSH",args:[{prim:"nat"},{int:"1"}]},{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"PAIR"},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"UNPAIR"},{prim:"ABS"},{prim:"DIG",args:[{int:"2"}]},{prim:"MUL"},{prim:"EDIV"},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"DivByZero"}]},{prim:"FAILWITH"}],[]]},{prim:"CAR"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"1"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"1"}]},{prim:"DROP",args:[{int:"1"}]},{prim:"DUG",args:[{int:"5"}]},{prim:"DROP",args:[{int:"5"}]}]]},{prim:"NIL",args:[{prim:"operation"}]},{prim:"DIG",args:[{int:"3"}]},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"},{prim:"UNPAIR"},{prim:"SWAP"}]]},{prim:"IF_LEFT",args:[[{prim:"DROP",args:[{int:"1"}]},{prim:"DIG",args:[{int:"5"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"6"}]},{prim:"NOW"},{prim:"COMPARE"},{prim:"GT"},{prim:"NOT"},{prim:"IF",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"InvalidCondition: r1"}]},{prim:"FAILWITH"}],[]]},{prim:"PUSH",args:[{prim:"mutez"},{int:"1"}]},{prim:"AMOUNT"},{prim:"EDIV"},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"DivByZero"}]},{prim:"FAILWITH"}],[{prim:"DUP"},{prim:"CAR"},{prim:"SWAP"},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"PUSH",args:[{prim:"int"},{int:"1"}]},{prim:"PUSH",args:[{prim:"nat"},{int:"1"}]},{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"INT"},{prim:"PAIR"},{prim:"DIG",args:[{int:"13"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"14"}]},{prim:"DIG",args:[{int:"7"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"8"}]},{prim:"DIG",args:[{int:"7"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"8"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"11"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"12"}]},{prim:"PAIR"},{prim:"EXEC"},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"UNPAIR"}]]},{prim:"UNPAIR"},{prim:"DIP",args:[{int:"1"},[{prim:"SWAP"}]]},{prim:"MUL"},{prim:"DIP",args:[{int:"1"},[{prim:"MUL"}]]},{prim:"PAIR"},{prim:"PAIR"},{prim:"UNPAIR"},{prim:"UNPAIR"},{prim:"DIG",args:[{int:"2"}]},{prim:"MUL"},{prim:"EDIV"},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"DivByZero"}]},{prim:"FAILWITH"}],[]]},{prim:"CAR"},{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"DIG",args:[{int:"1"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"2"}]},{prim:"COMPARE"},{prim:"GT"},{prim:"IF",args:[[{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"DIG",args:[{int:"1"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"2"}]},{prim:"NOW"},{prim:"ADD"},{prim:"ADD"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"7"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"7"}]},{prim:"NOW"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"6"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"6"}]},{prim:"SENDER"},{prim:"SOME"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"3"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"3"}]}],[]]},{prim:"DROP",args:[{int:"2"}]},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"DIG",args:[{int:"1"}]},{prim:"PAIR"}],[{prim:"IF_LEFT",args:[[{prim:"DROP",args:[{int:"1"}]},{prim:"DIG",args:[{int:"5"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"6"}]},{prim:"NOW"},{prim:"COMPARE"},{prim:"LT"},{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"NoneValue"}]},{prim:"FAILWITH"}],[]]},{prim:"SENDER"},{prim:"COMPARE"},{prim:"EQ"},{prim:"AND"},{prim:"NOT"},{prim:"IF",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"InvalidCondition: r2"}]},{prim:"FAILWITH"}],[]]},{prim:"DIG",args:[{int:"8"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"9"}]},{prim:"SENDER"},{prim:"CONTRACT",args:[{prim:"unit"}]},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"BadContract"}]},{prim:"FAILWITH"}],[]]},{prim:"DIG",args:[{int:"11"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"12"}]},{prim:"DIG",args:[{int:"13"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"14"}]},{prim:"DIG",args:[{int:"7"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"8"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"6"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"7"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"10"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"11"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"9"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"10"}]},{prim:"PAIR"},{prim:"EXEC"},{prim:"UNIT"},{prim:"TRANSFER_TOKENS"},{prim:"CONS"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"8"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"8"}]},{prim:"DUP"},{prim:"NOW"},{prim:"SUB"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"5"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"5"}]},{prim:"DUP"},{prim:"NOW"},{prim:"SUB"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"4"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"4"}]},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"DIG",args:[{int:"1"}]},{prim:"PAIR"}],[{prim:"IF_LEFT",args:[[{prim:"DROP",args:[{int:"1"}]},{prim:"DIG",args:[{int:"7"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"8"}]},{prim:"SENDER"},{prim:"COMPARE"},{prim:"EQ"},{prim:"NOT"},{prim:"IF",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"InvalidCaller"}]},{prim:"FAILWITH"}],[]]},{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]},{prim:"DIG",args:[{int:"6"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"7"}]},{prim:"NOW"},{prim:"COMPARE"},{prim:"LT"},{prim:"IF",args:[[{prim:"DIG",args:[{int:"10"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"11"}]},{prim:"DIG",args:[{int:"12"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"13"}]},{prim:"DIG",args:[{int:"6"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"7"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"5"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"6"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"9"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"10"}]},{prim:"PAIR"},{prim:"DIG",args:[{int:"8"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"9"}]},{prim:"PAIR"},{prim:"EXEC"},{prim:"SWAP"},{prim:"DROP",args:[{int:"1"}]}],[]]},{prim:"PUSH",args:[{prim:"mutez"},{int:"0"}]},{prim:"DIG",args:[{int:"1"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"2"}]},{prim:"BALANCE"},{prim:"SUB"},{prim:"COMPARE"},{prim:"GT"},{prim:"IF",args:[[{prim:"DIG",args:[{int:"9"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"10"}]},{prim:"DIG",args:[{int:"9"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"10"}]},{prim:"CONTRACT",args:[{prim:"unit"}]},{prim:"IF_NONE",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"BadContract"}]},{prim:"FAILWITH"}],[]]},{prim:"DIG",args:[{int:"2"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"3"}]},{prim:"BALANCE"},{prim:"SUB"},{prim:"UNIT"},{prim:"TRANSFER_TOKENS"},{prim:"CONS"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"9"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"9"}]}],[]]},{prim:"DROP",args:[{int:"1"}]},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"DIG",args:[{int:"1"}]},{prim:"PAIR"}],[{prim:"UNPAIR"},{prim:"SWAP"},{prim:"DIG",args:[{int:"9"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"10"}]},{prim:"SENDER"},{prim:"COMPARE"},{prim:"EQ"},{prim:"NOT"},{prim:"IF",args:[[{prim:"PUSH",args:[{prim:"string"},{string:"InvalidCaller"}]},{prim:"FAILWITH"}],[]]},{prim:"DIG",args:[{int:"1"}]},{prim:"DUP"},{prim:"DUG",args:[{int:"2"}]},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"5"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"5"}]},{prim:"DUP"},{prim:"DIP",args:[{int:"1"},[{prim:"DIG",args:[{int:"4"}]},{prim:"DROP",args:[{int:"1"}]}]]},{prim:"DUG",args:[{int:"4"}]},{prim:"DROP",args:[{int:"2"}]},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"SWAP"},{prim:"PAIR"},{prim:"DIG",args:[{int:"1"}]},{prim:"PAIR"}]]}]]}]]},{prim:"DIP",args:[{int:"1"},[{prim:"DROP",args:[{int:"2"}]}]]}]]}],I=(r,t)=>({prim:"Pair",args:[{string:r},{prim:"Pair",args:[t,{prim:"Pair",args:[{int:"1618169559"},{prim:"Pair",args:[{int:"1618169559"},{prim:"Pair",args:[{int:"60"},{prim:"Pair",args:[{int:"1000000"},{prim:"Pair",args:[{prim:"None"},{int:"5"}]}]}]}]}]}]}]});var D=i(228),f=i(610);const O=r=>{const t=t=>{r.setMain(t.target.checked)};if(Object(d.d)()){const r=Object(d.b)();return n.a.createElement(p.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},n.a.createElement(o.a,{variant:"subtitle2"},"Connected with:"),n.a.createElement(o.a,{variant:"subtitle2",style:{fontFamily:"Courier Prime, monospace"}},r))}return n.a.createElement(p.a,{container:!0},n.a.createElement(p.a,{item:!0,xs:8},n.a.createElement(u.a,{main:r.main})),n.a.createElement(p.a,{item:!0,xs:2},n.a.createElement(f.a,{checked:r.main,onChange:t,name:"checkedB",color:"primary"})),n.a.createElement(p.a,{item:!0,xs:2},n.a.createElement(o.a,{variant:"subtitle2",style:{marginTop:"8px"}},"Mainnet")))};const h=r=>n.a.createElement(p.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},n.a.createElement(o.a,{variant:"subtitle2"},"Contract available at:"),n.a.createElement(o.a,{component:D.a,to:"https://better-call.dev/"+(r.main?"mainnet":"edo2net")+"/"+r.contract+"/operations",variant:"subtitle2",style:{fontFamily:"Courier Prime, monospace"}},r.contract)),A=()=>{const[r,t]=n.a.useState(""),[e,o]=n.a.useState(1.5),[c,l]=n.a.useState(""),[b,u]=n.a.useState(!1),{setInfoSnack:D,setErrorSnack:f,hideSnack:A}=Object(g.b)(),N=Object(d.e)(),U=Object(d.d)(),j=()=>{return r.length>0&(36!==(t=r).length|!t.startsWith("tz1"));var t},R=()=>!(e>0);return n.a.createElement(a.a,{style:{backgroundColor:"transparent",border:"1px solid #606770",marginTop:"20px",marginBottom:"20px"},raised:!1},n.a.createElement(p.a,{container:!0,style:{padding:22},spacing:3},n.a.createElement(p.a,{item:!0,xs:6},n.a.createElement(m.a,{onChange:r=>{t(r.target.value)},value:r,variant:"outlined",color:"primary",fullWidth:!0,required:!0,id:"initalholder",label:"Owner",error:j(),helperText:j()?"Invalid address format":""})),n.a.createElement(p.a,{item:!0,xs:6,style:{textAlign:"center",marginTop:"10px"}},n.a.createElement(O,{main:b,setMain:u})),n.a.createElement(p.a,{item:!0,xs:6},n.a.createElement(m.a,{type:"number",onChange:r=>{o(r.target.value)},error:R(),helperText:R()?"Invalid Number":"",value:e,variant:"outlined",color:"primary",fullWidth:!0,required:!0,id:"totalsupply",label:"Rate"})),n.a.createElement(p.a,{item:!0,xs:6,style:{textAlign:"center",marginTop:"10px"}},""!==c?n.a.createElement(h,{contract:c,main:b}):n.a.createElement(s.a,{variant:"contained",color:"primary",disableElevation:!0,disabled:!U|R()|j()|0==r.length,onClick:async()=>{try{const t=new(0,i(354).Fraction)(e),n={prim:"Pair",args:[{int:t.numerator.toString()},{int:t.denominator.toString()}]},a=await N.wallet.originate({code:P,init:I(r,n)}).send(),p=a.opHash.substring(0,10)+"...";D(`waiting for ${p} to be confirmed ...`);const m=await a.contract();A(),console.log(`Origination completed for ${m.address}.`),setTimeout((()=>l(m.address)),5e3)}catch(t){console.log(t),f(t.message),setTimeout(A,4e3)}}},"originate"))))};t.a=r=>{const t=n.a.useMemo((()=>Object(c.a)({palette:{type:"dark",primary:{light:"#1dc5ff",main:"#00ACE7",dark:"#0a90bf",contrastText:"#fff"}}})),[!0]);return n.a.createElement(d.a,{appName:"Completium IOT"},n.a.createElement(g.a,null,n.a.createElement(l.a,{theme:t},n.a.createElement(A,null),n.a.createElement(b.a,null))))}}}]);