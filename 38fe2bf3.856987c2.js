(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{105:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return l})),n.d(t,"toc",(function(){return p})),n.d(t,"default",(function(){return d}));var a=n(3),i=n(7),o=(n(0),n(207)),r=n(210),c=n(208),s={id:"first6",title:"Claim ownership",sidebar_label:"6. Claim ownership",slug:"/dapp-first/claim"},l={unversionedId:"dapp-first/first6",id:"dapp-first/first6",isDocsHomePage:!1,title:"Claim ownership",description:"The goal is to add a Claim button and claim the ownership.",source:"@site/docs/dapp-first/first6.md",slug:"/dapp-first/claim",permalink:"/docs/dapp-first/claim",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/dapp-first/first6.md",version:"current",sidebar_label:"6. Claim ownership",sidebar:"first",previous:{title:"Make a bid",permalink:"/docs/dapp-first/make-bid"},next:{title:"To go further",permalink:"/docs/dapp-first/further"}},p=[{value:"Claim button",id:"claim-button",children:[]},{value:"Claim",id:"claim",children:[]}],b={toc:p};function d(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"The goal is to add a ",Object(o.b)("em",{parentName:"p"},"Claim")," button and claim the ownership."),Object(o.b)("h2",{id:"claim-button"},"Claim button"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Copy")," the code below and ",Object(o.b)("strong",{parentName:"p"},"insert")," it line 23 of ",Object(o.b)("inlineCode",{parentName:"p"},"~/src/App.js")," to define the ClaimButton:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js",metastring:"{8}","{8}":!0}),'const ClaimButton = () => {\n  const tezos = useTezos();\n  const account = useAccountPkh();\n  const { setInfoSnack, setErrorSnack, hideSnack } = useSnackContext();\n  const claim = async () => {\n    try {\n      const contract  = await tezos.wallet.at(contractAddress);\n      const operation = await contract.methods.claim(UnitValue).send();\n      const shorthash = operation.opHash.substring(0, 10) + "...";\n      setInfoSnack(`waiting for ${ shorthash } to be confirmed ...`);\n      await operation.receipt();\n      hideSnack();\n    } catch (error) {\n      setErrorSnack(error.message);\n      setTimeout(hideSnack, 4000);\n    }\n  }\n  return (\n    <Button onClick={ claim } variant="outlined" disabled={ account === null }>\n      Claim\n    </Button>);\n}\n')),Object(o.b)("p",null,"The implementation is very similar to the one of the ",Object(o.b)(c.a,{to:"/docs/dapp-first/bid-button#buttons-code",mdxType:"Link"},"Bid")," button. The differences are:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"it does not require any transfer of tezis, hence the ",Object(o.b)("inlineCode",{parentName:"li"},"send")," method does not have any argument"),Object(o.b)("li",{parentName:"ul"},"the ",Object(o.b)(c.a,{to:"/docs/dapp-first/contract#entrypoints",mdxType:"Link"},"contract"),"'s ",Object(o.b)("inlineCode",{parentName:"li"},"claim")," method is called")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Insert")," the code below line 125 of ",Object(o.b)("inlineCode",{parentName:"p"},"~/src/App.js")," to add the ",Object(o.b)("inlineCode",{parentName:"p"},"ClaimButton"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-html"}),"<Grid item xs={12}>\n  <ClaimButton />\n</Grid>\n")),Object(o.b)("h2",{id:"claim"},"Claim"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Click")," the ",Object(o.b)("em",{parentName:"p"},"Claim")," button and confirm the wallet popup. When operation is confirmed (snack message disappears), refresh the Better Call Dev ",Object(o.b)(c.a,{to:"/docs/dapp-first/make-bid#set-asset-up-for-sale",mdxType:"Link"},"contract page")," and check the effect on the contract (click on the ",Object(o.b)("inlineCode",{parentName:"p"},"claim")," operation):"),Object(o.b)(r.a,{img:"ownership_bcd3.png",width:"100%",mdxType:"DappFigure"}),Object(o.b)("p",null,"Notes:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"Owner")," has been set to the account in your walletn, which means you are now the owner of the asset!"),Object(o.b)("li",{parentName:"ul"},"Contract state is back to ",Object(o.b)("inlineCode",{parentName:"li"},"0"),' which is "Not For Sale".')),Object(o.b)("p",null,"The internal transaction (at the bottom in the screenshot above) is the transfer of the contract balance (10 tezis) to the previous owner, as per the ",Object(o.b)(c.a,{to:"/docs/dapp-first/contract#entrypoints",mdxType:"Link"},"contract")," entrypoint ",Object(o.b)("inlineCode",{parentName:"p"},"claim"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-archetype",metastring:"{5}","{5}":!0}),"transition claim () {\n  ...\n  with effect {\n    ...\n    transfer balance to owner;\n    ...\n  }\n}\n")))}d.isMDXComponent=!0}}]);