(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{149:function(t,e,n){"use strict";n.r(e),n.d(e,"frontMatter",(function(){return s})),n.d(e,"metadata",(function(){return b})),n.d(e,"toc",(function(){return d})),n.d(e,"default",(function(){return p}));var o=n(3),a=n(7),i=(n(0),n(204)),c=n(207),r=n(206),s={id:"first4",title:"Bid button",sidebar_label:"4. Bid button",slug:"/dapp-first/bid-button"},b={unversionedId:"dapp-first/first4",id:"dapp-first/first4",isDocsHomePage:!1,title:"Bid button",description:"The goal is to add a Post Bid button to call the contract.",source:"@site/docs/dapp-first/first4.md",slug:"/dapp-first/bid-button",permalink:"/docs/dapp-first/bid-button",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/dapp-first/first4.md",version:"current",sidebar_label:"4. Bid button",sidebar:"first",previous:{title:"Display contract data",permalink:"/docs/dapp-first/display-storage"},next:{title:"Make a bid",permalink:"/docs/dapp-first/make-bid"}},d=[{value:"Button&#39;s code",id:"buttons-code",children:[]},{value:"Wallet button",id:"wallet-button",children:[]}],l={toc:d};function p(t){var e=t.components,n=Object(a.a)(t,["components"]);return Object(i.b)("wrapper",Object(o.a)({},l,n,{components:e,mdxType:"MDXLayout"}),Object(i.b)("p",null,"The goal is to add a ",Object(i.b)("em",{parentName:"p"},"Post Bid")," button to call the contract."),Object(i.b)("h2",{id:"buttons-code"},"Button's code"),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Copy")," the code below and ",Object(i.b)("strong",{parentName:"p"},"insert")," it line 17 of ",Object(i.b)("inlineCode",{parentName:"p"},"~/src/App.js")," to define the ",Object(i.b)("inlineCode",{parentName:"p"},"BidButton"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-js",metastring:"{12-13,16}","{12-13,16}":!0}),"import Button from '@material-ui/core/Button';\nimport { useTezos, useAccountPkh } from './dappstate';\nimport { useSnackContext } from './snackstate';\nimport { UnitValue } from '@taquito/taquito';\n\nconst BidButton = () => {\n  const tezos = useTezos();\n  const account = useAccountPkh();\n  const { setInfoSnack, setErrorSnack, hideSnack } = useSnackContext();\n  const bid = async () => {\n    try {\n      const contract  = await tezos.wallet.at(contractAddress);\n      const operation = await contract.methods.bid(UnitValue).send({ amount: 10 });\n      const shorthash = operation.opHash.substring(0, 10) + \"...\";\n      setInfoSnack(`waiting for ${ shorthash } to be confirmed ...`);\n      await operation.receipt();\n      hideSnack();\n    } catch (error) {\n      setErrorSnack(error.message);\n      setTimeout(hideSnack, 4000);\n    }\n  }\n  return (\n    <Button onClick={ bid } variant=\"outlined\" disabled={ account === null }>\n      post bid\n    </Button>);\n}\n")),Object(i.b)("p",null,"The highlighted lines above show the interactions with the wallet:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"the contract is retrieved through the ",Object(i.b)("inlineCode",{parentName:"li"},"Tezos")," object provided by the wallet"),Object(i.b)("li",{parentName:"ul"},"the ",Object(i.b)("inlineCode",{parentName:"li"},"bid")," method defined in the ",Object(i.b)(r.a,{to:"/docs/dapp-first/contract#entrypoints",mdxType:"Link"},"contract"),", is invoked to forge and sign the operation, which is posted to the blockchain with ",Object(i.b)("inlineCode",{parentName:"li"},"send")),Object(i.b)("li",{parentName:"ul"},"the operation handler returns a ",Object(i.b)("inlineCode",{parentName:"li"},"receipt")," when the transaction is confirmed")),Object(i.b)("p",null,"Note that the contract's ",Object(i.b)("inlineCode",{parentName:"p"},"bid")," method does not take any argument, and that its javascript counterpart takes the default ",Object(i.b)("inlineCode",{parentName:"p"},"UnitValue")," value."),Object(i.b)("p",null,"Note that 10 tezies are sent to the contract with the ",Object(i.b)("inlineCode",{parentName:"p"},"send")," argument ",Object(i.b)("inlineCode",{parentName:"p"},"{ amount: 10 }"),". It is the value of the bid. This amount is refered to with the ",Object(i.b)(r.a,{to:"/docs/dapp-tools/archetype",mdxType:"Link"},"Archetype")," keyword ",Object(i.b)("inlineCode",{parentName:"p"},"transferred")," in the contract ",Object(i.b)(r.a,{to:"/docs/dapp-first/contract#source-code",mdxType:"Link"},"code"),"."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Insert")," the code below line 112 of ",Object(i.b)("inlineCode",{parentName:"p"},"~/src/App.js")," to add the ",Object(i.b)("inlineCode",{parentName:"p"},"BidButton"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-html"}),"<Grid item xs={12}>\n  <BidButton />\n</Grid>\n")),Object(i.b)("h2",{id:"wallet-button"},"Wallet button"),Object(i.b)("p",null,"The ",Object(i.b)("em",{parentName:"p"},"Bid")," button is disabled if the DApp is not connected to the ",Object(i.b)(r.a,{to:"/docs/dapp-tools/thanos",mdxType:"Link"},"Temple wallet")," (see ",Object(i.b)("inlineCode",{parentName:"p"},"disabled={account === null}")," above)."),Object(i.b)("p",null,"The project provides a utility button ",Object(i.b)("inlineCode",{parentName:"p"},"WalletButton")," to connect to the wallet. It is defined in ",Object(i.b)("inlineCode",{parentName:"p"},"~/src/components/WalletButton.js"),"."),Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Insert")," the code below line 115 of ",Object(i.b)("inlineCode",{parentName:"p"},"~/src/App.js"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(o.a)({parentName:"pre"},{className:"language-html"}),"<Grid item xs={12}>\n  <WalletButton />\n</Grid>\n")),Object(i.b)("p",null,"If the ",Object(i.b)(r.a,{to:"/docs/dapp-tools/thanos",mdxType:"Link"},"Temple wallet")," is not installed, the button displays as below:"),Object(i.b)(c.a,{img:"wallet_button1.png",width:"50%",mdxType:"DappFigure"}),Object(i.b)("p",null,"Click the button to go to the install page."),Object(i.b)("p",null,"When/If the ",Object(i.b)(r.a,{to:"/docs/dapp-tools/thanos",mdxType:"Link"},"Temple wallet")," is installed, the button displays as below:"),Object(i.b)(c.a,{img:"wallet_button2.png",width:"50%",mdxType:"DappFigure"}))}p.isMDXComponent=!0}}]);