(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{144:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return d})),a.d(n,"metadata",(function(){return l})),a.d(n,"toc",(function(){return p})),a.d(n,"default",(function(){return u}));var t=a(3),r=a(7),o=(a(0),a(236)),d={id:"dex12",title:"Implementation",sidebar_label:"Implementation",slug:"/dapp-dex/fa12implementation"},l={unversionedId:"dapp-dex/dex12",id:"dapp-dex/dex12",isDocsHomePage:!1,title:"Implementation",description:"Transfer",source:"@site/docs/dapp-dex/dex12.md",slug:"/dapp-dex/fa12implementation",permalink:"/docs/dapp-dex/fa12implementation",editUrl:"https://github.com/edukera/completium-landing/tree/master/docs/dapp-dex/dex12.md",version:"current",sidebar_label:"Implementation"},p=[{value:"Transfer",id:"transfer",children:[]},{value:"Approve",id:"approve",children:[]}],c={toc:p};function u(e){var n=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(t.a)({},c,a,{components:n,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"transfer"},"Transfer"),Object(o.b)("pre",null,Object(o.b)("code",Object(t.a)({parentName:"pre"},{className:"language-archetype"}),'entry %transfer (%from : address, %to : address, value : nat) {\n  require {\n    r1 otherwise "NotEnoughBalance" : ledger[%from].tokens >= value;\n  }\n  effect {\n    if caller <> %from then (\n      var current = allowance[(%from, caller)].amount;\n      dofailif(current < value, ("NotEnoughAllowance", ((value, current))));\n      allowance.update((%from, caller), { amount -=  value });\n    );\n    ledger.update(%from, { tokens -= value });\n    ledger.addupdate(%to, { tokens += value });\n  }\n}\n')),Object(o.b)("h2",{id:"approve"},"Approve"),Object(o.b)("pre",null,Object(o.b)("code",Object(t.a)({parentName:"pre"},{className:"language-archetype"}),'entry approve(spender : address, value : nat) {\n  var k = (caller, spender);\n  if allowance.contains(k) then (\n    var previous = allowance[k].amount;\n    dofailif(previous > 0 and value > 0, (("UnsafeAllowanceChange", previous)));\n  );\n  allowance.addupdate( k, { amount = value });\n}\n')))}u.isMDXComponent=!0}}]);