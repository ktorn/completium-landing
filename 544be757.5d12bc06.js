(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{129:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return r})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return s}));var o=n(3),c=(n(0),n(224)),i=n(225);const a={id:"tuto2",title:"Execution Conditions",sidebar_label:"2. Execution conditions",slug:"/contract/tuto/archetype-execcond"},r={unversionedId:"contract/tuto/tuto2",id:"contract/tuto/tuto2",isDocsHomePage:!1,title:"Execution Conditions",description:"One of the key requirements of a smart contract's entry point is to establish execution conditions:",source:"@site/docs/contract/tuto/tuto2.md",slug:"/contract/tuto/archetype-execcond",permalink:"/docs/contract/tuto/archetype-execcond",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/contract/tuto/tuto2.md",version:"current",sidebar_label:"2. Execution conditions",sidebar:"contract",previous:{title:"Hello Tezos world",permalink:"/docs/contract/tuto/archetype-hello"},next:{title:"Rationals and transfers",permalink:"/docs/contract/tuto/archetype-rattrans"}},l=[{value:"Code",id:"code",children:[]},{value:"Deploy",id:"deploy",children:[]},{value:"Call entry point",id:"call-entry-point",children:[]},{value:"View contract",id:"view-contract",children:[]}],d={toc:l};function s({components:e,...t}){return Object(c.b)("wrapper",Object(o.a)({},d,t,{components:e,mdxType:"MDXLayout"}),Object(c.b)("p",null,"One of the key requirements of a smart contract's entry point is to establish execution conditions:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Who can call the contract?"),Object(c.b)("li",{parentName:"ul"},"Under which logical conditions?")),Object(c.b)("p",null,"Archetype provides dedicated syntax to make execution conditions very explicit and non ambiguous."),Object(c.b)("h2",{id:"code"},"Code"),Object(c.b)("p",null,"In the following example, the entry point may only be called by the ",Object(c.b)("inlineCode",{parentName:"p"},"admin")," address; it also requires that the argument value ",Object(c.b)("inlineCode",{parentName:"p"},"v")," be between 10 (included) and 20 (strictly) and be even otherwise; if not even, it must be failed with this following message : ",Object(c.b)("inlineCode",{parentName:"p"},"Expected even value"),":"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{className:"language-archetype",metastring:"{8,10,11}","{8,10,11}":!0}),'archetype exec_condition\n\nvariable value : nat = 0\n\nconstant admin : address = @tz1MZrh8CvYkp7BfLQMcm6mg5FvL5HRZfACw\n\nentry main(v : nat) {\n  called by admin\n  require {\n      r1: 10 <= v < 20;\n      r2 otherwise "EXPECTED EVEN VALUE": value % 2 = 0\n  }\n  effect {\n     value := v;\n  }\n}\n')),Object(c.b)("p",null,"It is also possible to establish execution conditions with a ",Object(c.b)("inlineCode",{parentName:"p"},"failif")," section.\nExecution conditions have identifiers (here ",Object(c.b)("inlineCode",{parentName:"p"},"r1")," and ",Object(c.b)("inlineCode",{parentName:"p"},"r2"),") used for fail message when no ",Object(c.b)("inlineCode",{parentName:"p"},"otherwise")," is established, and to name the property in contract formal verification."),Object(c.b)("h2",{id:"deploy"},"Deploy"),Object(c.b)("p",null,"The following ",Object(c.b)(i.a,{to:"/docs/cli",mdxType:"Link"},"Completium CLI")," command deploys the contract on the Tezos network:"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{}),"completium-cli deploy 2-exec_condition.arl\n")),Object(c.b)("h2",{id:"call-entry-point"},"Call entry point"),Object(c.b)("p",null,"The following command calls the unique entry point with the argument ",Object(c.b)("inlineCode",{parentName:"p"},"14")," using the ",Object(c.b)("inlineCode",{parentName:"p"},"--with")," option:"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{}),"completium-cli call 2-exec-condition --with '14'\n")),Object(c.b)("h2",{id:"view-contract"},"View contract"),Object(c.b)("p",null,"The following command generates the URL to view the contract in Better call Dev:"),Object(c.b)("pre",null,Object(c.b)("code",Object(o.a)({parentName:"pre"},{}),"completium-cli show contract 2-exec-condition\n")))}s.isMDXComponent=!0}}]);