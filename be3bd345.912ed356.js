(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{105:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return s})),n.d(t,"metadata",(function(){return p})),n.d(t,"toc",(function(){return b})),n.d(t,"default",(function(){return m}));var a=n(3),r=n(7),i=(n(0),n(118)),c=n(129),o=n(131),l=n(120),s={id:"miles3",title:"Create Miles",sidebar_label:"Create Miles",slug:"/dapp-miles/miles-use-case2"},p={unversionedId:"dapp-miles/miles3",id:"dapp-miles/miles3",isDocsHomePage:!1,title:"Create Miles",description:"The first step is to provide the user account with some miles to spend on reward items in the user interface.",source:"@site/docs/dapp-miles/miles3.md",slug:"/dapp-miles/miles-use-case2",permalink:"/completium-landing/docs/dapp-miles/miles-use-case2",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/dapp-miles/miles3.md",version:"current",sidebar_label:"Create Miles",sidebar:"miles",previous:{title:"Prerequisites",permalink:"/completium-landing/docs/dapp-miles/miles-use-case1"},next:{title:"Consume Miles",permalink:"/completium-landing/docs/dapp-miles/miles-use-case3"}},b=[{value:"<code>add</code> entry point",id:"add-entry-point",children:[]},{value:"Miles creation transaction",id:"miles-creation-transaction",children:[]}],d={toc:b};function m(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},d,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"The first step is to provide the user account with some miles to spend on reward items in the user interface."),Object(i.b)("p",null,"To do so, invoke the ",Object(i.b)("inlineCode",{parentName:"p"},"add")," entry point of the smart contract. In a real life production situation, miles are created by the application off-chain server which creates miles according to user activity."),Object(i.b)("p",null,"In this DApp example, the off-chain server is not provided and the creation operation is done manually by invoking the smart contract's ",Object(i.b)("inlineCode",{parentName:"p"},"add")," entry point:"),Object(i.b)("h2",{id:"add-entry-point"},Object(i.b)("inlineCode",{parentName:"h2"},"add")," entry point"),Object(i.b)("p",null,"The entry point to create miles and associate to a user address is presented below:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-archetype"}),"entry add (ow : address,\n           newmile_id : string,\n           newmile_amount : int,\n           newmile_expiration : date) {\n   called by admin\n   require {\n     c1 : newmile_amount > 0;\n   }\n   failif {\n     c2 : mile.contains(newmile_id);\n   }\n   effect {\n     ...\n   }\n}\n")),Object(i.b)("p",null,"The ",Object(i.b)("inlineCode",{parentName:"p"},"called by admin")," instruction line 5 specifies that only the admin address can call the entry point."),Object(i.b)("p",null,"Hence it is necessary to invoke this entry point ",Object(i.b)("u",null,"with the admin address"),". If you have not registered the admin address in the wallet, go to the ",Object(i.b)("u",null,Object(i.b)(l.a,{to:"/docs/dapp-miles/miles-use-case1",mdxType:"Link"},"Prerequisites"))," page."),Object(i.b)("h2",{id:"miles-creation-transaction"},"Miles creation transaction"),Object(i.b)("p",null,"The smart contract is available at the following address:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"KT1F5DqPwKJC9qeEjTgdEQKGGBZpcAv5DX86\n")),Object(i.b)("p",null,"This section presents how to invoke the ",Object(i.b)("inlineCode",{parentName:"p"},"add")," entry point with the smart contract indexer 'Better Call Dev'; click the button blow to open the smart contract:"),Object(i.b)(o.a,{url:"https://better-call.dev/delphinet/KT1F5DqPwKJC9qeEjTgdEQKGGBZpcAv5DX86/operations",txt:"open smart contract",mdxType:"DappButton"}),Object(i.b)("p",null,'Click on the "Interact" tab and enter the parameters as presented below:'),Object(i.b)("table",null,Object(i.b)("thead",{parentName:"table"},Object(i.b)("tr",{parentName:"thead"},Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Parameter"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:"center"}),"Value"),Object(i.b)("th",Object(a.a)({parentName:"tr"},{align:"right"}),"Description"))),Object(i.b)("tbody",{parentName:"table"},Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"ow"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"YOUR USER ADDRESS"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"right"}),"address of the created miles' owner")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"newmile_id"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),'"USER_ADDRESS_0"'),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"right"}),"a unique for the created miles")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"newmile_amount"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"20"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"right"}),"number of miles to create")),Object(i.b)("tr",{parentName:"tbody"},Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"newmile_expiration"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"center"}),"TOMORROW'S DATE"),Object(i.b)("td",Object(a.a)({parentName:"tr"},{align:"right"}),"date beyond which miles are expired")))),Object(i.b)("p",null,"where:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},'"YOUR USER ADDRESS" is replaced by the DApp user account to receive the miles'),Object(i.b)("li",{parentName:"ul"},"TOMORROW'S DATE is replaced by a date in the future, for example tomorrow")),Object(i.b)("p",null,"Below is an example screenshot (with USER ADDRESS set to 'tz1dZydwVDuz6SH5jCUfCQjqV8YCQimL9GCp') of the interact panel:"),Object(i.b)(c.a,{img:"bcd-miles-2.png",width:"100%",mdxType:"DappFigure"}),Object(i.b)("p",null,'Once settings are set, click on the "Execute" button and select "Thanos":'),Object(i.b)(c.a,{img:"bcd-miles-3.png",width:"60%",mdxType:"DappFigure"}),Object(i.b)("p",null,"Once sent, the transaction should take a minute to be confirmed. When confirmed, you may click on the transaction to visualize the evolution of the contract storage. On the screenshot below, check create miles (highlighted in green):"),Object(i.b)(c.a,{img:"bcd-miles-4.png",width:"100%",mdxType:"DappFigure"}),Object(i.b)("p",null,"Next step is to go to the user interface to spend these 20 miles on reward items!"))}m.isMDXComponent=!0},118:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return u}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=r.a.createContext({}),p=function(e){var t=r.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},b=function(e){var t=p(e.components);return r.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),b=p(n),m=a,u=b["".concat(c,".").concat(m)]||b[m]||d[m]||i;return n?r.a.createElement(u,o(o({ref:t},s),{},{components:n})):r.a.createElement(u,o({ref:t},s))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,c=new Array(i);c[0]=m;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:a,c[1]=o;for(var s=2;s<i;s++)c[s]=n[s];return r.a.createElement.apply(null,c)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},129:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(119);t.a=function(e){return r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement("img",{alt:"Docusaurus with Keytar",style:{width:e.width,paddingTop:"40px",paddingBottom:"40px"},src:Object(i.a)("img/"+e.img)}))}},131:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(233),c=n(208),o=n(231),l=n(120),s=n(119);t.a=function(e){const t=r.a.useMemo((()=>Object(c.a)({palette:{type:"dark"}})),[!0]);return r.a.createElement("div",{style:{textAlign:"center",paddingTop:"0px",paddingBottom:"40px"}},r.a.createElement(o.a,{theme:t},e.internal?r.a.createElement(i.a,{variant:"outlined",size:"large",component:l.a,to:Object(s.a)("docs/"+e.url+"/")},e.txt):r.a.createElement(i.a,{variant:"outlined",size:"large",onClick:()=>window.open(e.url,"_blank")},e.txt)))}}}]);