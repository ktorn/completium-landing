(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{140:function(e,n,a){"use strict";a.r(n),a.d(n,"frontMatter",(function(){return o})),a.d(n,"metadata",(function(){return d})),a.d(n,"toc",(function(){return l})),a.d(n,"default",(function(){return c}));var t=a(3),r=(a(0),a(224));const o={id:"dex12",title:"Implementation",sidebar_label:"Implementation",slug:"/dapp-dex/fa12implementation"},d={unversionedId:"dapp-dex/dex12",id:"dapp-dex/dex12",isDocsHomePage:!1,title:"Implementation",description:"Transfer",source:"@site/docs/dapp-dex/dex12.md",slug:"/dapp-dex/fa12implementation",permalink:"/docs/dapp-dex/fa12implementation",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/dapp-dex/dex12.md",version:"current",sidebar_label:"Implementation"},l=[{value:"Transfer",id:"transfer",children:[]},{value:"Approve",id:"approve",children:[]}],p={toc:l};function c({components:e,...n}){return Object(r.b)("wrapper",Object(t.a)({},p,n,{components:e,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"transfer"},"Transfer"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-archetype"}),'entry %transfer (%from : address, %to : address, value : nat) {\n  require {\n    r1 otherwise "NotEnoughBalance" : ledger[%from].tokens >= value;\n  }\n  effect {\n    if caller <> %from then (\n      var current = allowance[(%from, caller)].amount;\n      dofailif(current < value, ("NotEnoughAllowance", ((value, current))));\n      allowance.update((%from, caller), { amount -=  value });\n    );\n    ledger.update(%from, { tokens -= value });\n    ledger.addupdate(%to, { tokens += value });\n  }\n}\n')),Object(r.b)("h2",{id:"approve"},"Approve"),Object(r.b)("pre",null,Object(r.b)("code",Object(t.a)({parentName:"pre"},{className:"language-archetype"}),'entry approve(spender : address, value : nat) {\n  var k = (caller, spender);\n  if allowance.contains(k) then (\n    var previous = allowance[k].amount;\n    dofailif(previous > 0 and value > 0, (("UnsafeAllowanceChange", previous)));\n  );\n  allowance.addupdate( k, { amount = value });\n}\n')))}c.isMDXComponent=!0}}]);