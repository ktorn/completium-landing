(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{176:function(t,e,n){"use strict";n.r(e),n.d(e,"frontMatter",(function(){return s})),n.d(e,"metadata",(function(){return u})),n.d(e,"toc",(function(){return d})),n.d(e,"default",(function(){return b}));var r=n(3),o=n(7),i=(n(0),n(184)),a=n(185),p=n(186),c=n(187),s={id:"iot40",title:"Interrupt",sidebar_label:"Interrupt",slug:"/dapp-iot/interrupt"},u={unversionedId:"dapp-iot/iot40",id:"dapp-iot/iot40",isDocsHomePage:!1,title:"Interrupt",description:'It is possible to interrupt the service by clicking the "Interrupt" button:',source:"@site/docs/dapp-iot/iot40.md",slug:"/dapp-iot/interrupt",permalink:"/completium-landing/docs/dapp-iot/interrupt",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/dapp-iot/iot40.md",version:"current",sidebar_label:"Interrupt",sidebar:"iot",previous:{title:"Switch on",permalink:"/completium-landing/docs/dapp-iot/switchon"},next:{title:"Technical guide presentation",permalink:"/completium-landing/docs/dapp-iot/tg-presentation"}},d=[],l={toc:d};function b(t){var e=t.components,n=Object(o.a)(t,["components"]);return Object(i.b)("wrapper",Object(r.a)({},l,n,{components:e,mdxType:"MDXLayout"}),Object(i.b)("p",null,'It is possible to interrupt the service by clicking the "Interrupt" button:'),Object(i.b)(a.a,{img:"iot-duration.png",width:"60%",mdxType:"DappFigure"}),Object(i.b)("p",null,"It generates the following transaction parameter:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),'[{\n    "kind":"transaction"\n    "to":"KT1CxHBiCSvmXn9kXCbhPfdGDAggGG9ktQEX"\n    "amount":0\n    "mutez":true\n    "parameter":{\n        "entrypoint":"interrupt"\n        "value":{\n            "prim":"Unit"\n        }\n    }\n}]\n')),Object(i.b)("p",null,"It is possible to check the corresponding transactions in the ",Object(i.b)(c.a,{to:"/docs/dapp-tools/bcd",mdxType:"Link"},"Better Call Dev")," indexer:"),Object(i.b)(a.a,{img:"iot-bcd.png",width:"100%",mdxType:"DappFigure"}),Object(i.b)("p",null,"We note in the screenshot above that the smart contract pays back to the ",Object(i.b)("em",{parentName:"p"},"caller")," an amount in prorata of the session duration, as formulated in the smart contract ",Object(i.b)(c.a,{to:"/docs/dapp-iot/implementation#interrupt",mdxType:"Link"},"interrupt")," entry point:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-archetype",metastring:"{2,11}","{2,11}":!0}),"function get_return_tz () : tez {\n    var res : int = 1 / get_rate_in_s_by_utz() * (dateofstop - now);\n    return (res * 1utz)\n}\n\nentry interrupt () {\n    require {\n        r2: caller = opt_get(user) and now < dateofstop\n    }\n    effect {\n        transfer (get_return_tz()) to caller;\n        dateofstop  := now - read_interval;\n        dateofstart := now - read_interval;\n    }\n}\n")),Object(i.b)(p.a,{url:"https://better-call.dev/delphinet/KT1CxHBiCSvmXn9kXCbhPfdGDAggGG9ktQEX/operations",txt:"open contract",mdxType:"DappButton"}))}b.isMDXComponent=!0}}]);